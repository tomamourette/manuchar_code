
/*
 ************************************************************************************************************
 *	Create Stored Procedure.																				*
 ************************************************************************************************************
*/

CREATE PROCEDURE [21D365_ods].[usp_Insertvendinvoicejour]

AS

BEGIN

	/*
	 ********************************************************************************************************
	 *	Update the ODSHashValue Field in the Staging table with the Hash value of the record.				*
	 ********************************************************************************************************
	*/

	UPDATE A
	   SET [ODSHashValue] = CAST(HASHBYTES('MD5', ISNULL(SUBSTRING([Id], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([SinkCreatedOn] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL(CAST([SinkModifiedOn] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([constarget_jp], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([correct_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([correctiontype_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([documentorigin], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([facturedfully_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([incltax], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([intercompanyposted], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([inventprofiletype_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([invoicetype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([listcode], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([nonrealrevenue_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([operationtype_mx], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([prepayment], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([proforma], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([purchasetype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([servicecodeondlvaddress_br], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([stateinvoiceprinted_lv], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([taxprintoninvoice], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([taxspecifybyline], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([triangulation], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([unitedvatinvoice_lt], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vatonpayment_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vendfinaluser_br], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([whoisauthor_lt], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([psnpurchasingcardtype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([sysdatastatecode], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([orderaccount], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([attorneydate_ru] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([attorneyid_ru], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([attorneyissuedname_ru], 1, 255), '') + '|' + 							CAST(ISNULL([banklcimportline], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([cashdisc], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([cashdisccode], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([cashdiscdate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([cashdiscpercent], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([consigneeaccount_ru], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([consignoraccount_ru], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([contractnum_sa], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([correctedinvoicedate_ru] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([correctedinvoiceid_ru], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([costledgervoucher], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([countryregionid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([currencycode], 1, 255), '') + '|' + 							CAST(ISNULL([defaultdimension], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([deliveryaddress_lt], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([deliverydate_es] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([deliveryname], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([deliveryname_lt], 1, 255), '') + '|' + 							CAST(ISNULL([deliverypostaladdress], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([description], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([dlvaddress_lv], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([dlvmode], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([dlvterm], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([documentdate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([documentnum], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([duedate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([enddisc], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([enddiscmst], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([enterprisenumber], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([eusaleslist], 1, 255), '') + '|' + 							CAST(ISNULL([exchrate], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([exchratesecondary], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([fiscaldocumenttype_br], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([fixedduedate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([intercompanycompanyid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([intercompanyledgervoucher], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([intercompanysalesid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([internalinvoiceid], 1, 255), '') + '|' + 							CAST(ISNULL([intrastataddvalue_lv], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([intrastatdispatch], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([intrastatfulfillmentdate_hu] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([inventbaileereceiptreportid_ru], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([invoiceaccount], 1, 255), '') + '|' + 							CAST(ISNULL([invoiceamount], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([invoiceamountmst], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([invoicedate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([invoiceid], 1, 255), '') + '|' + 							CAST(ISNULL([invoiceroundoff], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([itembuyergroupid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([languageid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([ledgervoucher], 1, 255), '') + '|' + 							CAST(ISNULL([logisticselectronicaddress], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([numbersequencecode_lt], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([numbersequencegroup], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([offsessionid_ru], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([parmid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([paymdayid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([payment], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([paymentsched], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([paymid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([postingprofile], 1, 255), '') + '|' + 							CAST(ISNULL([purchagreementheader_psn], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([purchid], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([purchreceiptdate_w] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([qty], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([reasontableref_br], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([remittanceaddress], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([returnitemnum], 1, 255), '') + '|' + 							CAST(ISNULL([reversechargeamount], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([salesbalance], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([salespurchoperationtype_br], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([sourcedocumentheader], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([sourcedocumentline], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([sumlinedisc], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([summarkup], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([summarkupmst], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([sumtax], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([taxgroup], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([taxinvoicepurchid], 1, 255), '') + '|' + 							CAST(ISNULL([taxroundoff], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([taxsetoffvoucher_in], 1, 255), '') + '|' + 							CAST(ISNULL([taxwithholdamount_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([transportationdocument], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vatamount_in], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([vatnum], 1, 255), '') + '|' + 							CAST(ISNULL([vendconsinvoice_jp], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([vendgroup], 1, 255), '') + '|' + 							CAST(ISNULL([vendinvoicedeclaration_is], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([vendinvoicegroup], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([vendorrequestedworkeremail], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([vendpaymentgroup], 1, 255), '') + '|' + 							CAST(ISNULL([volume], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([weight], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([cfdiuuid_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([invoiceseries_mx], 1, 255), '') + '|' + 							CAST(ISNULL([reversecharge_uk], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([reportingcurrencyexchangerate], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([importedsalestax], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([receiveddate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([importedamount], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([taxid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([partytaxid], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([state], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([intentletterid_it], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([plafonddate_it] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL(CAST([vendorvatdate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([electronicinvoiceframeworktype_fr], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([invoiceaccountservicecode_fr], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([projectmanager_fr], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([projectmanagerservicecode_fr], 1, 255), '') + '|' + 							CAST(ISNULL([projectmanagerservicecoderef_fr], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([invoiceaccountservicecoderef_fr], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecsvendorbalance], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecsvendorbalancemst], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([ecssettlementcontractid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([lgslogisticfileid], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([modifieddatetime] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([modifiedby], 1, 255), '') + '|' + 							CAST(ISNULL([modifiedtransactionid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([createddatetime] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([createdby], 1, 255), '') + '|' + 							CAST(ISNULL([createdtransactionid], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([dataareaid], 1, 255), '') + '|' + 							CAST(ISNULL([recversion], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([partition], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([sysrowversion], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([recid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([tableid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([versionnumber], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([createdon] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL(CAST([modifiedon] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([IsDelete], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([PartitionId], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([Ingestion_Timestamp], 1, 255), '')) AS BINARY(16))
	  FROM [21D365_stg].[vendinvoicejour] A; 

							 
	/*
	 ********************************************************************************************************
	 *	If the Destination table has no records update the Staging table Record Source with the value (N)ew.*
	 ********************************************************************************************************
	*/

	IF NOT EXISTS (SELECT count(*) FROM [21D365_ods].[vendinvoicejour] HAVING count(*) > 0)
	BEGIN
	    UPDATE [21D365_stg].[vendinvoicejour]
		   SET [ODSRecordStatus] = 'N'
		 WHERE [ODSRecordStatus] IS NULL
	END;

	/*
	 ********************************************************************************************************
	 *	If the Destination table is not empty Update the ODSRecordStatus with values (N), (C) or (S).		*
	 ********************************************************************************************************
	*/

	IF EXISTS (SELECT count(*) FROM [21D365_ods].[vendinvoicejour] HAVING count(*) > 0)
	BEGIN

		UPDATE A
		   SET A.[ODSRecordStatus] = 'N'
		  FROM [21D365_stg].[vendinvoicejour] A LEFT JOIN [21D365_ods].[vendinvoicejour] B
		    ON A.[recid] = B.[recid]
		 WHERE B.[recid] IS NULL

		UPDATE A
		   SET A.[ODSRecordStatus] = 'C'
		  FROM [21D365_stg].[vendinvoicejour] A INNER JOIN [21D365_ods].[vendinvoicejour] B
		    ON A.[recid] = B.[recid]
		   AND A.[ODSHashValue] <> B.[ODSHashValue]

		UPDATE A
		   SET A.[ODSRecordStatus] = 'S'
		  FROM [21D365_stg].[vendinvoicejour] A INNER JOIN [21D365_ods].[vendinvoicejour] B
		    ON A.[recid] = B.[recid]
		   AND A.[ODSHashValue] = B.[ODSHashValue]
	END;				
	/*
	 ********************************************************************************************************
	 *	Update ODS Fields if table Exists.																	*
	 ********************************************************************************************************
	*/

	UPDATE A
	   SET A.[ODSEndDate] = GETDATE(),
		   A.[ODSActive] = CONVERT(BIT, 0)
	  FROM [21D365_ods].[vendinvoicejour] A INNER JOIN [21D365_stg].[vendinvoicejour] B
	    ON A.[recid] = B.[recid]
	 WHERE B.[ODSRecordStatus] = 'C'
	   AND A.[ODSEndDate] = CONVERT(DATETIME, '31-12-9999', 103)
	   AND A.[ODSActive] = CONVERT(BIT, 1); 
	
	/*
	 ********************************************************************************************************
	 *	Insert New And Changed records in the ODS Table.													*
	 ********************************************************************************************************
	*/

	INSERT INTO [21D365_ods].[vendinvoicejour]			(			 [Id],			 [SinkCreatedOn],			 [SinkModifiedOn],			 [constarget_jp],			 [correct_ru],			 [correctiontype_ru],			 [documentorigin],			 [facturedfully_ru],			 [incltax],			 [intercompanyposted],			 [inventprofiletype_ru],			 [invoicetype],			 [listcode],			 [nonrealrevenue_ru],			 [operationtype_mx],			 [prepayment],			 [proforma],			 [purchasetype],			 [servicecodeondlvaddress_br],			 [stateinvoiceprinted_lv],			 [taxprintoninvoice],			 [taxspecifybyline],			 [triangulation],			 [unitedvatinvoice_lt],			 [vatonpayment_ru],			 [vendfinaluser_br],			 [whoisauthor_lt],			 [psnpurchasingcardtype],			 [sysdatastatecode],			 [orderaccount],			 [attorneydate_ru],			 [attorneyid_ru],			 [attorneyissuedname_ru],			 [banklcimportline],			 [cashdisc],			 [cashdisccode],			 [cashdiscdate],			 [cashdiscpercent],			 [consigneeaccount_ru],			 [consignoraccount_ru],			 [contractnum_sa],			 [correctedinvoicedate_ru],			 [correctedinvoiceid_ru],			 [costledgervoucher],			 [countryregionid],			 [currencycode],			 [defaultdimension],			 [deliveryaddress_lt],			 [deliverydate_es],			 [deliveryname],			 [deliveryname_lt],			 [deliverypostaladdress],			 [description],			 [dlvaddress_lv],			 [dlvmode],			 [dlvterm],			 [documentdate],			 [documentnum],			 [duedate],			 [enddisc],			 [enddiscmst],			 [enterprisenumber],			 [eusaleslist],			 [exchrate],			 [exchratesecondary],			 [fiscaldocumenttype_br],			 [fixedduedate],			 [intercompanycompanyid],			 [intercompanyledgervoucher],			 [intercompanysalesid],			 [internalinvoiceid],			 [intrastataddvalue_lv],			 [intrastatdispatch],			 [intrastatfulfillmentdate_hu],			 [inventbaileereceiptreportid_ru],			 [invoiceaccount],			 [invoiceamount],			 [invoiceamountmst],			 [invoicedate],			 [invoiceid],			 [invoiceroundoff],			 [itembuyergroupid],			 [languageid],			 [ledgervoucher],			 [logisticselectronicaddress],			 [numbersequencecode_lt],			 [numbersequencegroup],			 [offsessionid_ru],			 [parmid],			 [paymdayid],			 [payment],			 [paymentsched],			 [paymid],			 [postingprofile],			 [purchagreementheader_psn],			 [purchid],			 [purchreceiptdate_w],			 [qty],			 [reasontableref_br],			 [remittanceaddress],			 [returnitemnum],			 [reversechargeamount],			 [salesbalance],			 [salespurchoperationtype_br],			 [sourcedocumentheader],			 [sourcedocumentline],			 [sumlinedisc],			 [summarkup],			 [summarkupmst],			 [sumtax],			 [taxgroup],			 [taxinvoicepurchid],			 [taxroundoff],			 [taxsetoffvoucher_in],			 [taxwithholdamount_in],			 [transportationdocument],			 [vatamount_in],			 [vatnum],			 [vendconsinvoice_jp],			 [vendgroup],			 [vendinvoicedeclaration_is],			 [vendinvoicegroup],			 [vendorrequestedworkeremail],			 [vendpaymentgroup],			 [volume],			 [weight],			 [cfdiuuid_mx],			 [invoiceseries_mx],			 [reversecharge_uk],			 [reportingcurrencyexchangerate],			 [importedsalestax],			 [receiveddate],			 [importedamount],			 [taxid],			 [partytaxid],			 [state],			 [intentletterid_it],			 [plafonddate_it],			 [vendorvatdate],			 [electronicinvoiceframeworktype_fr],			 [invoiceaccountservicecode_fr],			 [projectmanager_fr],			 [projectmanagerservicecode_fr],			 [projectmanagerservicecoderef_fr],			 [invoiceaccountservicecoderef_fr],			 [ecsvendorbalance],			 [ecsvendorbalancemst],			 [ecssettlementcontractid],			 [lgslogisticfileid],			 [modifieddatetime],			 [modifiedby],			 [modifiedtransactionid],			 [createddatetime],			 [createdby],			 [createdtransactionid],			 [dataareaid],			 [recversion],			 [partition],			 [sysrowversion],			 [recid],			 [tableid],			 [versionnumber],			 [createdon],			 [modifiedon],			 [IsDelete],			 [PartitionId],			 [Ingestion_Timestamp],			 [ODSStartDate],			 [ODSEndDate],			 [ODSActive],			 [ODSHashValue]			) 	  SELECT [Id],			 [SinkCreatedOn],			 [SinkModifiedOn],			 [constarget_jp],			 [correct_ru],			 [correctiontype_ru],			 [documentorigin],			 [facturedfully_ru],			 [incltax],			 [intercompanyposted],			 [inventprofiletype_ru],			 [invoicetype],			 [listcode],			 [nonrealrevenue_ru],			 [operationtype_mx],			 [prepayment],			 [proforma],			 [purchasetype],			 [servicecodeondlvaddress_br],			 [stateinvoiceprinted_lv],			 [taxprintoninvoice],			 [taxspecifybyline],			 [triangulation],			 [unitedvatinvoice_lt],			 [vatonpayment_ru],			 [vendfinaluser_br],			 [whoisauthor_lt],			 [psnpurchasingcardtype],			 [sysdatastatecode],			 [orderaccount],			 [attorneydate_ru],			 [attorneyid_ru],			 [attorneyissuedname_ru],			 [banklcimportline],			 [cashdisc],			 [cashdisccode],			 [cashdiscdate],			 [cashdiscpercent],			 [consigneeaccount_ru],			 [consignoraccount_ru],			 [contractnum_sa],			 [correctedinvoicedate_ru],			 [correctedinvoiceid_ru],			 [costledgervoucher],			 [countryregionid],			 [currencycode],			 [defaultdimension],			 [deliveryaddress_lt],			 [deliverydate_es],			 [deliveryname],			 [deliveryname_lt],			 [deliverypostaladdress],			 [description],			 [dlvaddress_lv],			 [dlvmode],			 [dlvterm],			 [documentdate],			 [documentnum],			 [duedate],			 [enddisc],			 [enddiscmst],			 [enterprisenumber],			 [eusaleslist],			 [exchrate],			 [exchratesecondary],			 [fiscaldocumenttype_br],			 [fixedduedate],			 [intercompanycompanyid],			 [intercompanyledgervoucher],			 [intercompanysalesid],			 [internalinvoiceid],			 [intrastataddvalue_lv],			 [intrastatdispatch],			 [intrastatfulfillmentdate_hu],			 [inventbaileereceiptreportid_ru],			 [invoiceaccount],			 [invoiceamount],			 [invoiceamountmst],			 [invoicedate],			 [invoiceid],			 [invoiceroundoff],			 [itembuyergroupid],			 [languageid],			 [ledgervoucher],			 [logisticselectronicaddress],			 [numbersequencecode_lt],			 [numbersequencegroup],			 [offsessionid_ru],			 [parmid],			 [paymdayid],			 [payment],			 [paymentsched],			 [paymid],			 [postingprofile],			 [purchagreementheader_psn],			 [purchid],			 [purchreceiptdate_w],			 [qty],			 [reasontableref_br],			 [remittanceaddress],			 [returnitemnum],			 [reversechargeamount],			 [salesbalance],			 [salespurchoperationtype_br],			 [sourcedocumentheader],			 [sourcedocumentline],			 [sumlinedisc],			 [summarkup],			 [summarkupmst],			 [sumtax],			 [taxgroup],			 [taxinvoicepurchid],			 [taxroundoff],			 [taxsetoffvoucher_in],			 [taxwithholdamount_in],			 [transportationdocument],			 [vatamount_in],			 [vatnum],			 [vendconsinvoice_jp],			 [vendgroup],			 [vendinvoicedeclaration_is],			 [vendinvoicegroup],			 [vendorrequestedworkeremail],			 [vendpaymentgroup],			 [volume],			 [weight],			 [cfdiuuid_mx],			 [invoiceseries_mx],			 [reversecharge_uk],			 [reportingcurrencyexchangerate],			 [importedsalestax],			 [receiveddate],			 [importedamount],			 [taxid],			 [partytaxid],			 [state],			 [intentletterid_it],			 [plafonddate_it],			 [vendorvatdate],			 [electronicinvoiceframeworktype_fr],			 [invoiceaccountservicecode_fr],			 [projectmanager_fr],			 [projectmanagerservicecode_fr],			 [projectmanagerservicecoderef_fr],			 [invoiceaccountservicecoderef_fr],			 [ecsvendorbalance],			 [ecsvendorbalancemst],			 [ecssettlementcontractid],			 [lgslogisticfileid],			 [modifieddatetime],			 [modifiedby],			 [modifiedtransactionid],			 [createddatetime],			 [createdby],			 [createdtransactionid],			 [dataareaid],			 [recversion],			 [partition],			 [sysrowversion],			 [recid],			 [tableid],			 [versionnumber],			 [createdon],			 [modifiedon],			 [IsDelete],			 [PartitionId],			 [Ingestion_Timestamp],			 GETUTCDATE(),			 CONVERT(DATETIME, '31-12-9999', 103),			 CONVERT(BIT, 1),			 [ODSHashValue] 		FROM [21D365_stg].[vendinvoicejour] WHERE [ODSRecordStatus] IN ('C', 'N');					   
				
/*
 ************************************************************************************************************
 *	End of creating the stored procedure.																	*
 ************************************************************************************************************
*/

END

GO

