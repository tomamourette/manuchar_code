
/*
 ************************************************************************************************************
 *	Create Stored Procedure.																				*
 ************************************************************************************************************
*/

CREATE PROCEDURE [21D365_ods].[usp_Insertvendtable]

AS

BEGIN

	/*
	 ********************************************************************************************************
	 *	Update the ODSHashValue Field in the Staging table with the Hash value of the record.				*
	 ********************************************************************************************************
	*/

	UPDATE A
	   SET [ODSHashValue] = CAST(HASHBYTES('MD5', ISNULL(SUBSTRING([Id], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([SinkCreatedOn] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL(CAST([SinkModifiedOn] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([bidonly], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([blocked], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([cashaccountingregime_es], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([changerequestallowoverride], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([changerequestenabled], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([changerequestoverride], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([cisstatus], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([companytype_mx], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([disabledowned], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([fatcafilingrequirement], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([femaleowned], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([foreignentityindicator], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([foreignresident_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([heir_it], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([hubzone], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([icmscontributor_br], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([incltax], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([inventprofiletype_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ispaymfeecovered_jp], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([isresident_lv], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([locallyowned], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([mandatoryvatdate_pl], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([matchingpolicy], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([minorityowned], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([nontaxable_br], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([offsetaccounttype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([onetimevendor], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([operationtype_mx], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([presencetype_br], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([purchamountpurchaseorder], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([secondtin], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([servicecodeondlvaddress_br], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([smallbusiness], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([tax1099namechoice], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([tax1099reports], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([taxidtype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([taxwithholdcalculate], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([taxwithholdvendortype_th], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([unitedvatinvoice_lt], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([usecashdisc], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vatpartnerkind_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vattaxagent_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vendconsumption_br], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vendortype_mx], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([veteranowned], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([w9], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([w9included], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vendvendorcollaborationtype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([withholdingtaxpayertype_mx], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([originalvendorinreporting_it], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([isselfinvoicevendor_it], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([workflowstate], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([iscprb_br], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([cxmlorderenable], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vatnumtabletype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([overridesalestax], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([accruesalestaxtype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([taxvendorchargetaxtolerancevalidation], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([revenuetypology_it], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ispublicsector_it], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([istaxationoverpayroll_br], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([einvoiceregister_it], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([isunidentifiedbenef_br], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([itmimportcostingvendor], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([itmservicesprovider], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([itmvendtype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([sysdatastatecode], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([taxwithholdgroup], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([residenceforeigncountryregionid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([paymtermid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([linedisc], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([accountnum], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([bankaccount], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([bankcentralbankpurposecode], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([bankcentralbankpurposetext], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([bankcentralbanktranstypecur_ru], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([bankorderofpayment_ru], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([birthcountycode_it], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([birthplace], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([blockedreleasedate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([cashdisc], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([ccmnum_br], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([ciscompanyregnum], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([cisnationalinsurancenum], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([cisuniquetaxpayerref], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([cisverificationdate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([cisverificationnum], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([clearingperiod], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([cnae_br], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([cnpjcpfnum_br], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([commercialregister], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([commercialregisterinsetnumber], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([commercialregistersection], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([companychainid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([companyidsiret], 1, 255), '') + '|' + 							CAST(ISNULL([companynafcode], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([consday_jp], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([contactpersonid], 1, 255), '') + '|' + 							CAST(ISNULL([creditmax], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([creditrating], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([curp_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([currency], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([dba], 1, 255), '') + '|' + 							CAST(ISNULL([defaultdimension], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([defaultinventstatusid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([destinationcodeid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([diotcountrycode_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([dlvmode], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([dlvterm], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([enddisc], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([enterprisenumber], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([ethnicoriginid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([factoringaccount], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([finecode_br], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([fiscalcode], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([foreignerid_br], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([foreigntaxregistration_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([freightzone], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([ienum_br], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([insscei_br], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([intbank_lv], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([interestcode_br], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([inventlocation], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([inventprofileid_ru], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([inventsiteid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([invoiceaccount], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([itembuyergroupid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([lineofbusinessid], 1, 255), '') + '|' + 							CAST(ISNULL([lvpaymtranscodes], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([maincontactworker], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([markupgroup], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([memo], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([multilinedisc], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([namecontrol], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([nationality_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([nit_br], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([numbersequencegroup], 1, 255), '') + '|' + 							CAST(ISNULL([offsetledgerdimension], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([organizationnumber], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([orgid], 1, 255), '') + '|' + 							CAST(ISNULL([party], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([paymdayid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([paymid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([paymmode], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([paymsched], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([paymspec], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([pricegroup], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([purchcalendarid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([purchpoolid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([rfc_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([segmentid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([separatedivisionid_ru], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([stateinscription_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([structdepartment_ru], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([subsegmentid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([suppitemgroupid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([tamrebategroupid], 1, 255), '') + '|' + 							CAST(ISNULL([tax1099fields], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([tax1099regnum], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([taxgroup], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([taxperiodpaymentcode_pl], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([vatnum], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([vatoperationcode_ru], 1, 255), '') + '|' + 							CAST(ISNULL([vendexceptiongroup], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([vendgroup], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([vendincomecode_br], 1, 255), '') + '|' + 							CAST(ISNULL([vendinvoicedeclaration_is], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([venditemgroupid], 1, 255), '') + '|' + 							CAST(ISNULL([vendorportaladministratorrecid], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([vendpaymfeegroup_jp], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([vendpricetolerancegroupid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([youraccountnum], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([legalrepresentativecurp_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([legalrepresentativename_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([legalrepresentativerfc_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([withholdingtypecode_mx], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([birthdate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([regnum_w], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([enterprisecode], 1, 255), '') + '|' + 							CAST(ISNULL([vatnumrecid], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([purchaseshipcalendarid], 1, 255), '') + '|' + 							CAST(ISNULL([taxvendorchargetaxtoleranceamount], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([taxvendorchargetaxtolerancepercent], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([freenotesgroup_it], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([coderevenuetypology_it], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([itmfromport], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([itmoverundertolerancegroupid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([itmagent], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([itmvendaccount], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([itmcosttypegroupid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([avaabinamealias], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([gupdiscountvendorclaimgroupname], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([modifieddatetime] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([modifiedby], 1, 255), '') + '|' + 							CAST(ISNULL([modifiedtransactionid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([createddatetime] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([createdby], 1, 255), '') + '|' + 							CAST(ISNULL([createdtransactionid], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([dataareaid], 1, 255), '') + '|' + 							CAST(ISNULL([recversion], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([partition], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([sysrowversion], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([recid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([tableid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([versionnumber], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([createdon] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL(CAST([modifiedon] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([IsDelete], 0) AS NVARCHAR(50)) + '|' + 							ISNULL([PartitionId], '')) AS BINARY(16))
	  FROM [21D365_stg].[vendtable] A; 

							 
	/*
	 ********************************************************************************************************
	 *	If the Destination table has no records update the Staging table Record Source with the value (N)ew.*
	 ********************************************************************************************************
	*/

	IF NOT EXISTS (SELECT count(*) FROM [21D365_ods].[vendtable] HAVING count(*) > 0)
	BEGIN
	    UPDATE [21D365_stg].[vendtable]
		   SET [ODSRecordStatus] = 'N'
		 WHERE [ODSRecordStatus] IS NULL
	END;

	/*
	 ********************************************************************************************************
	 *	If the Destination table is not empty Update the ODSRecordStatus with values (N), (C) or (S).		*
	 ********************************************************************************************************
	*/

	IF EXISTS (SELECT count(*) FROM [21D365_ods].[vendtable] HAVING count(*) > 0)
	BEGIN

		UPDATE A
		   SET A.[ODSRecordStatus] = 'N'
		  FROM [21D365_stg].[vendtable] A LEFT JOIN [21D365_ods].[vendtable] B
		    ON A.[recid] = B.[recid]
		 WHERE B.[recid] IS NULL

		UPDATE A
		   SET A.[ODSRecordStatus] = 'C'
		  FROM [21D365_stg].[vendtable] A INNER JOIN [21D365_ods].[vendtable] B
		    ON A.[recid] = B.[recid]
		   AND A.[ODSHashValue] <> B.[ODSHashValue]

		UPDATE A
		   SET A.[ODSRecordStatus] = 'S'
		  FROM [21D365_stg].[vendtable] A INNER JOIN [21D365_ods].[vendtable] B
		    ON A.[recid] = B.[recid]
		   AND A.[ODSHashValue] = B.[ODSHashValue]
	END;				
	/*
	 ********************************************************************************************************
	 *	Update ODS Fields if table Exists.																	*
	 ********************************************************************************************************
	*/

	UPDATE A
	   SET A.[ODSEndDate] = GETDATE(),
		   A.[ODSActive] = CONVERT(BIT, 0)
	  FROM [21D365_ods].[vendtable] A INNER JOIN [21D365_stg].[vendtable] B
	    ON A.[recid] = B.[recid]
	 WHERE B.[ODSRecordStatus] = 'C'
	   AND A.[ODSEndDate] = CONVERT(DATETIME, '31-12-9999', 103)
	   AND A.[ODSActive] = CONVERT(BIT, 1); 
	
	/*
	 ********************************************************************************************************
	 *	Insert New And Changed records in the ODS Table.													*
	 ********************************************************************************************************
	*/

	INSERT INTO [21D365_ods].[vendtable]			(			 [Id],			 [SinkCreatedOn],			 [SinkModifiedOn],			 [bidonly],			 [blocked],			 [cashaccountingregime_es],			 [changerequestallowoverride],			 [changerequestenabled],			 [changerequestoverride],			 [cisstatus],			 [companytype_mx],			 [disabledowned],			 [fatcafilingrequirement],			 [femaleowned],			 [foreignentityindicator],			 [foreignresident_ru],			 [heir_it],			 [hubzone],			 [icmscontributor_br],			 [incltax],			 [inventprofiletype_ru],			 [ispaymfeecovered_jp],			 [isresident_lv],			 [locallyowned],			 [mandatoryvatdate_pl],			 [matchingpolicy],			 [minorityowned],			 [nontaxable_br],			 [offsetaccounttype],			 [onetimevendor],			 [operationtype_mx],			 [presencetype_br],			 [purchamountpurchaseorder],			 [secondtin],			 [servicecodeondlvaddress_br],			 [smallbusiness],			 [tax1099namechoice],			 [tax1099reports],			 [taxidtype],			 [taxwithholdcalculate],			 [taxwithholdvendortype_th],			 [unitedvatinvoice_lt],			 [usecashdisc],			 [vatpartnerkind_ru],			 [vattaxagent_ru],			 [vendconsumption_br],			 [vendortype_mx],			 [veteranowned],			 [w9],			 [w9included],			 [vendvendorcollaborationtype],			 [withholdingtaxpayertype_mx],			 [originalvendorinreporting_it],			 [isselfinvoicevendor_it],			 [workflowstate],			 [iscprb_br],			 [cxmlorderenable],			 [vatnumtabletype],			 [overridesalestax],			 [accruesalestaxtype],			 [taxvendorchargetaxtolerancevalidation],			 [revenuetypology_it],			 [ispublicsector_it],			 [istaxationoverpayroll_br],			 [einvoiceregister_it],			 [isunidentifiedbenef_br],			 [itmimportcostingvendor],			 [itmservicesprovider],			 [itmvendtype],			 [sysdatastatecode],			 [taxwithholdgroup],			 [residenceforeigncountryregionid],			 [paymtermid],			 [linedisc],			 [accountnum],			 [bankaccount],			 [bankcentralbankpurposecode],			 [bankcentralbankpurposetext],			 [bankcentralbanktranstypecur_ru],			 [bankorderofpayment_ru],			 [birthcountycode_it],			 [birthplace],			 [blockedreleasedate],			 [cashdisc],			 [ccmnum_br],			 [ciscompanyregnum],			 [cisnationalinsurancenum],			 [cisuniquetaxpayerref],			 [cisverificationdate],			 [cisverificationnum],			 [clearingperiod],			 [cnae_br],			 [cnpjcpfnum_br],			 [commercialregister],			 [commercialregisterinsetnumber],			 [commercialregistersection],			 [companychainid],			 [companyidsiret],			 [companynafcode],			 [consday_jp],			 [contactpersonid],			 [creditmax],			 [creditrating],			 [curp_mx],			 [currency],			 [dba],			 [defaultdimension],			 [defaultinventstatusid],			 [destinationcodeid],			 [diotcountrycode_mx],			 [dlvmode],			 [dlvterm],			 [enddisc],			 [enterprisenumber],			 [ethnicoriginid],			 [factoringaccount],			 [finecode_br],			 [fiscalcode],			 [foreignerid_br],			 [foreigntaxregistration_mx],			 [freightzone],			 [ienum_br],			 [insscei_br],			 [intbank_lv],			 [interestcode_br],			 [inventlocation],			 [inventprofileid_ru],			 [inventsiteid],			 [invoiceaccount],			 [itembuyergroupid],			 [lineofbusinessid],			 [lvpaymtranscodes],			 [maincontactworker],			 [markupgroup],			 [memo],			 [multilinedisc],			 [namecontrol],			 [nationality_mx],			 [nit_br],			 [numbersequencegroup],			 [offsetledgerdimension],			 [organizationnumber],			 [orgid],			 [party],			 [paymdayid],			 [paymid],			 [paymmode],			 [paymsched],			 [paymspec],			 [pricegroup],			 [purchcalendarid],			 [purchpoolid],			 [rfc_mx],			 [segmentid],			 [separatedivisionid_ru],			 [stateinscription_mx],			 [structdepartment_ru],			 [subsegmentid],			 [suppitemgroupid],			 [tamrebategroupid],			 [tax1099fields],			 [tax1099regnum],			 [taxgroup],			 [taxperiodpaymentcode_pl],			 [vatnum],			 [vatoperationcode_ru],			 [vendexceptiongroup],			 [vendgroup],			 [vendincomecode_br],			 [vendinvoicedeclaration_is],			 [venditemgroupid],			 [vendorportaladministratorrecid],			 [vendpaymfeegroup_jp],			 [vendpricetolerancegroupid],			 [youraccountnum],			 [legalrepresentativecurp_mx],			 [legalrepresentativename_mx],			 [legalrepresentativerfc_mx],			 [withholdingtypecode_mx],			 [birthdate],			 [regnum_w],			 [enterprisecode],			 [vatnumrecid],			 [purchaseshipcalendarid],			 [taxvendorchargetaxtoleranceamount],			 [taxvendorchargetaxtolerancepercent],			 [freenotesgroup_it],			 [coderevenuetypology_it],			 [itmfromport],			 [itmoverundertolerancegroupid],			 [itmagent],			 [itmvendaccount],			 [itmcosttypegroupid],			 [avaabinamealias],			 [gupdiscountvendorclaimgroupname],			 [modifieddatetime],			 [modifiedby],			 [modifiedtransactionid],			 [createddatetime],			 [createdby],			 [createdtransactionid],			 [dataareaid],			 [recversion],			 [partition],			 [sysrowversion],			 [recid],			 [tableid],			 [versionnumber],			 [createdon],			 [modifiedon],			 [IsDelete],			 [PartitionId],			 [ODSStartDate],			 [ODSEndDate],			 [ODSActive],			 [ODSHashValue]			) 	  SELECT [Id],			 [SinkCreatedOn],			 [SinkModifiedOn],			 [bidonly],			 [blocked],			 [cashaccountingregime_es],			 [changerequestallowoverride],			 [changerequestenabled],			 [changerequestoverride],			 [cisstatus],			 [companytype_mx],			 [disabledowned],			 [fatcafilingrequirement],			 [femaleowned],			 [foreignentityindicator],			 [foreignresident_ru],			 [heir_it],			 [hubzone],			 [icmscontributor_br],			 [incltax],			 [inventprofiletype_ru],			 [ispaymfeecovered_jp],			 [isresident_lv],			 [locallyowned],			 [mandatoryvatdate_pl],			 [matchingpolicy],			 [minorityowned],			 [nontaxable_br],			 [offsetaccounttype],			 [onetimevendor],			 [operationtype_mx],			 [presencetype_br],			 [purchamountpurchaseorder],			 [secondtin],			 [servicecodeondlvaddress_br],			 [smallbusiness],			 [tax1099namechoice],			 [tax1099reports],			 [taxidtype],			 [taxwithholdcalculate],			 [taxwithholdvendortype_th],			 [unitedvatinvoice_lt],			 [usecashdisc],			 [vatpartnerkind_ru],			 [vattaxagent_ru],			 [vendconsumption_br],			 [vendortype_mx],			 [veteranowned],			 [w9],			 [w9included],			 [vendvendorcollaborationtype],			 [withholdingtaxpayertype_mx],			 [originalvendorinreporting_it],			 [isselfinvoicevendor_it],			 [workflowstate],			 [iscprb_br],			 [cxmlorderenable],			 [vatnumtabletype],			 [overridesalestax],			 [accruesalestaxtype],			 [taxvendorchargetaxtolerancevalidation],			 [revenuetypology_it],			 [ispublicsector_it],			 [istaxationoverpayroll_br],			 [einvoiceregister_it],			 [isunidentifiedbenef_br],			 [itmimportcostingvendor],			 [itmservicesprovider],			 [itmvendtype],			 [sysdatastatecode],			 [taxwithholdgroup],			 [residenceforeigncountryregionid],			 [paymtermid],			 [linedisc],			 [accountnum],			 [bankaccount],			 [bankcentralbankpurposecode],			 [bankcentralbankpurposetext],			 [bankcentralbanktranstypecur_ru],			 [bankorderofpayment_ru],			 [birthcountycode_it],			 [birthplace],			 [blockedreleasedate],			 [cashdisc],			 [ccmnum_br],			 [ciscompanyregnum],			 [cisnationalinsurancenum],			 [cisuniquetaxpayerref],			 [cisverificationdate],			 [cisverificationnum],			 [clearingperiod],			 [cnae_br],			 [cnpjcpfnum_br],			 [commercialregister],			 [commercialregisterinsetnumber],			 [commercialregistersection],			 [companychainid],			 [companyidsiret],			 [companynafcode],			 [consday_jp],			 [contactpersonid],			 [creditmax],			 [creditrating],			 [curp_mx],			 [currency],			 [dba],			 [defaultdimension],			 [defaultinventstatusid],			 [destinationcodeid],			 [diotcountrycode_mx],			 [dlvmode],			 [dlvterm],			 [enddisc],			 [enterprisenumber],			 [ethnicoriginid],			 [factoringaccount],			 [finecode_br],			 [fiscalcode],			 [foreignerid_br],			 [foreigntaxregistration_mx],			 [freightzone],			 [ienum_br],			 [insscei_br],			 [intbank_lv],			 [interestcode_br],			 [inventlocation],			 [inventprofileid_ru],			 [inventsiteid],			 [invoiceaccount],			 [itembuyergroupid],			 [lineofbusinessid],			 [lvpaymtranscodes],			 [maincontactworker],			 [markupgroup],			 [memo],			 [multilinedisc],			 [namecontrol],			 [nationality_mx],			 [nit_br],			 [numbersequencegroup],			 [offsetledgerdimension],			 [organizationnumber],			 [orgid],			 [party],			 [paymdayid],			 [paymid],			 [paymmode],			 [paymsched],			 [paymspec],			 [pricegroup],			 [purchcalendarid],			 [purchpoolid],			 [rfc_mx],			 [segmentid],			 [separatedivisionid_ru],			 [stateinscription_mx],			 [structdepartment_ru],			 [subsegmentid],			 [suppitemgroupid],			 [tamrebategroupid],			 [tax1099fields],			 [tax1099regnum],			 [taxgroup],			 [taxperiodpaymentcode_pl],			 [vatnum],			 [vatoperationcode_ru],			 [vendexceptiongroup],			 [vendgroup],			 [vendincomecode_br],			 [vendinvoicedeclaration_is],			 [venditemgroupid],			 [vendorportaladministratorrecid],			 [vendpaymfeegroup_jp],			 [vendpricetolerancegroupid],			 [youraccountnum],			 [legalrepresentativecurp_mx],			 [legalrepresentativename_mx],			 [legalrepresentativerfc_mx],			 [withholdingtypecode_mx],			 [birthdate],			 [regnum_w],			 [enterprisecode],			 [vatnumrecid],			 [purchaseshipcalendarid],			 [taxvendorchargetaxtoleranceamount],			 [taxvendorchargetaxtolerancepercent],			 [freenotesgroup_it],			 [coderevenuetypology_it],			 [itmfromport],			 [itmoverundertolerancegroupid],			 [itmagent],			 [itmvendaccount],			 [itmcosttypegroupid],			 [avaabinamealias],			 [gupdiscountvendorclaimgroupname],			 [modifieddatetime],			 [modifiedby],			 [modifiedtransactionid],			 [createddatetime],			 [createdby],			 [createdtransactionid],			 [dataareaid],			 [recversion],			 [partition],			 [sysrowversion],			 [recid],			 [tableid],			 [versionnumber],			 [createdon],			 [modifiedon],			 [IsDelete],			 [PartitionId],			 GETUTCDATE(),			 CONVERT(DATETIME, '31-12-9999', 103),			 CONVERT(BIT, 1),			 [ODSHashValue] 		FROM [21D365_stg].[vendtable] WHERE [ODSRecordStatus] IN ('C', 'N');					   
				
/*
 ************************************************************************************************************
 *	End of creating the stored procedure.																	*
 ************************************************************************************************************
*/

END

GO

