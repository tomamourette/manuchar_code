
/*
 ************************************************************************************************************
 *	Create Stored Procedure.																				*
 ************************************************************************************************************
*/

CREATE PROCEDURE [21D365_ods].[usp_Insertvendinvoicetrans]

AS

BEGIN

	/*
	 ********************************************************************************************************
	 *	Update the ODSHashValue Field in the Staging table with the Hash value of the record.				*
	 ********************************************************************************************************
	*/

	UPDATE A
	   SET [ODSHashValue] = CAST(HASHBYTES('MD5', ISNULL(SUBSTRING([Id], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([SinkCreatedOn] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL(CAST([SinkModifiedOn] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([dsa_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([exciserecordtype_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([excisetype_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([facturedfully_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([gtaservicecategory_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([inventreftype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ispwp], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([linetype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([operationtype_mx], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([partdelivery], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([readyforpayment], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([reversecharge_w], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([stockedproduct], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([taxautogenerated], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vatdocumenttype_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vatgoodstype_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([overridesalestax], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([dctvatlistcode], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([sysdatastatecode], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([purchid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([destcountryregionid], 1, 255), '') + '|' + 							CAST(ISNULL([advanceapplicationid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([agreementline_psn], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([alcohollicenseseriesnum_ru], 1, 255), '') + '|' + 							CAST(ISNULL([assessablevalue_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([companylocation_in], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([countryregionname_ru], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([creditnotedate_in] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([currencycode], 1, 255), '') + '|' + 							CAST(ISNULL([customstariffcodetable_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([defaultdimension], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([deliveryname], 1, 255), '') + '|' + 							CAST(ISNULL([deliverypostaladdress], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([description], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([destcounty], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([deststate], 1, 255), '') + '|' + 							CAST(ISNULL([discamount], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([discpercent], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([exciseamount_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([exciseamountmst_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([excisetariffcodes_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([excisevalue_ru], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([externalitemid], 1, 255), '') + '|' + 							CAST(ISNULL([facturedqty_ru], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([intercompanyinventtransid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([internalinvoiceid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([intrastatdispatchid], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([intrastatfulfillmentdate_hu] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL(CAST([inventdate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([inventdimid], 1, 255), '') + '|' + 							CAST(ISNULL([inventqty], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([inventrefid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([inventreftransid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([inventtransid], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([invoicedate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([invoicegtdid_ru], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([invoiceid], 1, 255), '') + '|' + 							CAST(ISNULL([intrastatcommodity], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([itemid], 1, 255), '') + '|' + 							CAST(ISNULL([ledgerdimension], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([lineamount], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([lineamountmst], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([lineamountmst_w], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([lineamounttax], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([linedisc], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([linenum], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([linepercent], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([markupcode_ru], 1, 255), '') + '|' + 							CAST(ISNULL([maximumretailprice_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([multilndisc], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([multilnpercent], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([name], 1, 255), '') + '|' + 							CAST(ISNULL([ngpcodestable_fr], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([nonrecoverablepercent_in], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([numbersequencegroup], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([origcountryregionid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([origpurchid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([origstateid], 1, 255), '') + '|' + 							CAST(ISNULL([pdscwqty], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([pdscwqtyphysical], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([port], 1, 255), '') + '|' + 							CAST(ISNULL([priceunit], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([procurementcategory], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([psareleaseamount], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([psaretainageamount], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([purchaselinelinenumber], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([purchcommitmentline_psn], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([purchmarkup], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([purchprice], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([purchunit], 1, 255), '') + '|' + 							CAST(ISNULL([qty], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([qtyphysical], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([rbopackagelinenum], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([reasontableref], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([refreturninvoicetrans_w], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([registrationpostaladdress_in], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([retailpackageid], 1, 255), '') + '|' + 							CAST(ISNULL([salestaxformtypes_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([servicecodetable_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([settletax1099amount], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([settletax1099stateamount], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([sourcedocumentline], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([statisticvalue_lt], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([statprocid], 1, 255), '') + '|' + 							CAST(ISNULL([tax1099amount], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([tax1099date] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([tax1099fields], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([tax1099num], 1, 255), '') + '|' + 							CAST(ISNULL([tax1099recid], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([tax1099state], 1, 255), '') + '|' + 							CAST(ISNULL([tax1099stateamount], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([taxamount], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([taxamountmst_w], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([taxgroup], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([taxitemgroup], 1, 255), '') + '|' + 							CAST(ISNULL([taxwithholdbasecur_th], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([taxwithholdgroup_th], 1, 255), '') + '|' + 							CAST(ISNULL([taxwithholditemgroupheading_th], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([taxwithholdlinenum_in], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([taxwithholdvoucher_in], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([taxwritecode], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([tcsgroup_in], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([tdsgroup_in], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([transactioncode], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([transport], 1, 255), '') + '|' + 							CAST(ISNULL([vatamount_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vatamount_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vatamountmst_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vatdeferred_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vatexpense_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vatvalue_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([venddirective_psn], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vendorlocation_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([weight], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([itemcodeid], 1, 255), '') + '|' + 							CAST(ISNULL([budgetreservationline_psn], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([refcommreporttrans_ru], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([rskexchrate], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([rsktaxamountmst], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([rskfxhedgedtaxamount], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([rskpriceqty], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([rskpriceunit], 1, 255), '') + '|' + 							CAST(ISNULL([mnrgrossquantity], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([dctvatdispatchid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([dctvatfromcountry], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([dctvattocountry], 1, 255), '') + '|' + 							CAST(ISNULL([dctvatseqnum], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([modifieddatetime] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([modifiedby], 1, 255), '') + '|' + 							CAST(ISNULL([modifiedtransactionid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([createddatetime] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([createdby], 1, 255), '') + '|' + 							CAST(ISNULL([createdtransactionid], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([dataareaid], 1, 255), '') + '|' + 							CAST(ISNULL([recversion], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([partition], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([sysrowversion], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([recid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([tableid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([versionnumber], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([createdon] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL(CAST([modifiedon] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([IsDelete], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([PartitionId], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([Ingestion_Timestamp], 1, 255), '')) AS BINARY(16))
	  FROM [21D365_stg].[vendinvoicetrans] A; 

							 
	/*
	 ********************************************************************************************************
	 *	If the Destination table has no records update the Staging table Record Source with the value (N)ew.*
	 ********************************************************************************************************
	*/

	IF NOT EXISTS (SELECT count(*) FROM [21D365_ods].[vendinvoicetrans] HAVING count(*) > 0)
	BEGIN
	    UPDATE [21D365_stg].[vendinvoicetrans]
		   SET [ODSRecordStatus] = 'N'
		 WHERE [ODSRecordStatus] IS NULL
	END;

	/*
	 ********************************************************************************************************
	 *	If the Destination table is not empty Update the ODSRecordStatus with values (N), (C) or (S).		*
	 ********************************************************************************************************
	*/

	IF EXISTS (SELECT count(*) FROM [21D365_ods].[vendinvoicetrans] HAVING count(*) > 0)
	BEGIN

		UPDATE A
		   SET A.[ODSRecordStatus] = 'N'
		  FROM [21D365_stg].[vendinvoicetrans] A LEFT JOIN [21D365_ods].[vendinvoicetrans] B
		    ON A.[recid] = B.[recid]
		 WHERE B.[recid] IS NULL

		UPDATE A
		   SET A.[ODSRecordStatus] = 'C'
		  FROM [21D365_stg].[vendinvoicetrans] A INNER JOIN [21D365_ods].[vendinvoicetrans] B
		    ON A.[recid] = B.[recid]
		   AND A.[ODSHashValue] <> B.[ODSHashValue]

		UPDATE A
		   SET A.[ODSRecordStatus] = 'S'
		  FROM [21D365_stg].[vendinvoicetrans] A INNER JOIN [21D365_ods].[vendinvoicetrans] B
		    ON A.[recid] = B.[recid]
		   AND A.[ODSHashValue] = B.[ODSHashValue]
	END;				
	/*
	 ********************************************************************************************************
	 *	Update ODS Fields if table Exists.																	*
	 ********************************************************************************************************
	*/

	UPDATE A
	   SET A.[ODSEndDate] = GETDATE(),
		   A.[ODSActive] = CONVERT(BIT, 0)
	  FROM [21D365_ods].[vendinvoicetrans] A INNER JOIN [21D365_stg].[vendinvoicetrans] B
	    ON A.[recid] = B.[recid]
	 WHERE B.[ODSRecordStatus] = 'C'
	   AND A.[ODSEndDate] = CONVERT(DATETIME, '31-12-9999', 103)
	   AND A.[ODSActive] = CONVERT(BIT, 1); 
	
	/*
	 ********************************************************************************************************
	 *	Insert New And Changed records in the ODS Table.													*
	 ********************************************************************************************************
	*/

	INSERT INTO [21D365_ods].[vendinvoicetrans]			(			 [Id],			 [SinkCreatedOn],			 [SinkModifiedOn],			 [dsa_in],			 [exciserecordtype_in],			 [excisetype_in],			 [facturedfully_ru],			 [gtaservicecategory_in],			 [inventreftype],			 [ispwp],			 [linetype],			 [operationtype_mx],			 [partdelivery],			 [readyforpayment],			 [reversecharge_w],			 [stockedproduct],			 [taxautogenerated],			 [vatdocumenttype_ru],			 [vatgoodstype_in],			 [overridesalestax],			 [dctvatlistcode],			 [sysdatastatecode],			 [purchid],			 [destcountryregionid],			 [advanceapplicationid],			 [agreementline_psn],			 [alcohollicenseseriesnum_ru],			 [assessablevalue_in],			 [companylocation_in],			 [countryregionname_ru],			 [creditnotedate_in],			 [currencycode],			 [customstariffcodetable_in],			 [defaultdimension],			 [deliveryname],			 [deliverypostaladdress],			 [description],			 [destcounty],			 [deststate],			 [discamount],			 [discpercent],			 [exciseamount_ru],			 [exciseamountmst_ru],			 [excisetariffcodes_in],			 [excisevalue_ru],			 [externalitemid],			 [facturedqty_ru],			 [intercompanyinventtransid],			 [internalinvoiceid],			 [intrastatdispatchid],			 [intrastatfulfillmentdate_hu],			 [inventdate],			 [inventdimid],			 [inventqty],			 [inventrefid],			 [inventreftransid],			 [inventtransid],			 [invoicedate],			 [invoicegtdid_ru],			 [invoiceid],			 [intrastatcommodity],			 [itemid],			 [ledgerdimension],			 [lineamount],			 [lineamountmst],			 [lineamountmst_w],			 [lineamounttax],			 [linedisc],			 [linenum],			 [linepercent],			 [markupcode_ru],			 [maximumretailprice_in],			 [multilndisc],			 [multilnpercent],			 [name],			 [ngpcodestable_fr],			 [nonrecoverablepercent_in],			 [numbersequencegroup],			 [origcountryregionid],			 [origpurchid],			 [origstateid],			 [pdscwqty],			 [pdscwqtyphysical],			 [port],			 [priceunit],			 [procurementcategory],			 [psareleaseamount],			 [psaretainageamount],			 [purchaselinelinenumber],			 [purchcommitmentline_psn],			 [purchmarkup],			 [purchprice],			 [purchunit],			 [qty],			 [qtyphysical],			 [rbopackagelinenum],			 [reasontableref],			 [refreturninvoicetrans_w],			 [registrationpostaladdress_in],			 [retailpackageid],			 [salestaxformtypes_in],			 [servicecodetable_in],			 [settletax1099amount],			 [settletax1099stateamount],			 [sourcedocumentline],			 [statisticvalue_lt],			 [statprocid],			 [tax1099amount],			 [tax1099date],			 [tax1099fields],			 [tax1099num],			 [tax1099recid],			 [tax1099state],			 [tax1099stateamount],			 [taxamount],			 [taxamountmst_w],			 [taxgroup],			 [taxitemgroup],			 [taxwithholdbasecur_th],			 [taxwithholdgroup_th],			 [taxwithholditemgroupheading_th],			 [taxwithholdlinenum_in],			 [taxwithholdvoucher_in],			 [taxwritecode],			 [tcsgroup_in],			 [tdsgroup_in],			 [transactioncode],			 [transport],			 [vatamount_in],			 [vatamount_ru],			 [vatamountmst_ru],			 [vatdeferred_in],			 [vatexpense_in],			 [vatvalue_ru],			 [venddirective_psn],			 [vendorlocation_in],			 [weight],			 [itemcodeid],			 [budgetreservationline_psn],			 [refcommreporttrans_ru],			 [rskexchrate],			 [rsktaxamountmst],			 [rskfxhedgedtaxamount],			 [rskpriceqty],			 [rskpriceunit],			 [mnrgrossquantity],			 [dctvatdispatchid],			 [dctvatfromcountry],			 [dctvattocountry],			 [dctvatseqnum],			 [modifieddatetime],			 [modifiedby],			 [modifiedtransactionid],			 [createddatetime],			 [createdby],			 [createdtransactionid],			 [dataareaid],			 [recversion],			 [partition],			 [sysrowversion],			 [recid],			 [tableid],			 [versionnumber],			 [createdon],			 [modifiedon],			 [IsDelete],			 [PartitionId],			 [Ingestion_Timestamp],			 [ODSStartDate],			 [ODSEndDate],			 [ODSActive],			 [ODSHashValue]			) 	  SELECT [Id],			 [SinkCreatedOn],			 [SinkModifiedOn],			 [dsa_in],			 [exciserecordtype_in],			 [excisetype_in],			 [facturedfully_ru],			 [gtaservicecategory_in],			 [inventreftype],			 [ispwp],			 [linetype],			 [operationtype_mx],			 [partdelivery],			 [readyforpayment],			 [reversecharge_w],			 [stockedproduct],			 [taxautogenerated],			 [vatdocumenttype_ru],			 [vatgoodstype_in],			 [overridesalestax],			 [dctvatlistcode],			 [sysdatastatecode],			 [purchid],			 [destcountryregionid],			 [advanceapplicationid],			 [agreementline_psn],			 [alcohollicenseseriesnum_ru],			 [assessablevalue_in],			 [companylocation_in],			 [countryregionname_ru],			 [creditnotedate_in],			 [currencycode],			 [customstariffcodetable_in],			 [defaultdimension],			 [deliveryname],			 [deliverypostaladdress],			 [description],			 [destcounty],			 [deststate],			 [discamount],			 [discpercent],			 [exciseamount_ru],			 [exciseamountmst_ru],			 [excisetariffcodes_in],			 [excisevalue_ru],			 [externalitemid],			 [facturedqty_ru],			 [intercompanyinventtransid],			 [internalinvoiceid],			 [intrastatdispatchid],			 [intrastatfulfillmentdate_hu],			 [inventdate],			 [inventdimid],			 [inventqty],			 [inventrefid],			 [inventreftransid],			 [inventtransid],			 [invoicedate],			 [invoicegtdid_ru],			 [invoiceid],			 [intrastatcommodity],			 [itemid],			 [ledgerdimension],			 [lineamount],			 [lineamountmst],			 [lineamountmst_w],			 [lineamounttax],			 [linedisc],			 [linenum],			 [linepercent],			 [markupcode_ru],			 [maximumretailprice_in],			 [multilndisc],			 [multilnpercent],			 [name],			 [ngpcodestable_fr],			 [nonrecoverablepercent_in],			 [numbersequencegroup],			 [origcountryregionid],			 [origpurchid],			 [origstateid],			 [pdscwqty],			 [pdscwqtyphysical],			 [port],			 [priceunit],			 [procurementcategory],			 [psareleaseamount],			 [psaretainageamount],			 [purchaselinelinenumber],			 [purchcommitmentline_psn],			 [purchmarkup],			 [purchprice],			 [purchunit],			 [qty],			 [qtyphysical],			 [rbopackagelinenum],			 [reasontableref],			 [refreturninvoicetrans_w],			 [registrationpostaladdress_in],			 [retailpackageid],			 [salestaxformtypes_in],			 [servicecodetable_in],			 [settletax1099amount],			 [settletax1099stateamount],			 [sourcedocumentline],			 [statisticvalue_lt],			 [statprocid],			 [tax1099amount],			 [tax1099date],			 [tax1099fields],			 [tax1099num],			 [tax1099recid],			 [tax1099state],			 [tax1099stateamount],			 [taxamount],			 [taxamountmst_w],			 [taxgroup],			 [taxitemgroup],			 [taxwithholdbasecur_th],			 [taxwithholdgroup_th],			 [taxwithholditemgroupheading_th],			 [taxwithholdlinenum_in],			 [taxwithholdvoucher_in],			 [taxwritecode],			 [tcsgroup_in],			 [tdsgroup_in],			 [transactioncode],			 [transport],			 [vatamount_in],			 [vatamount_ru],			 [vatamountmst_ru],			 [vatdeferred_in],			 [vatexpense_in],			 [vatvalue_ru],			 [venddirective_psn],			 [vendorlocation_in],			 [weight],			 [itemcodeid],			 [budgetreservationline_psn],			 [refcommreporttrans_ru],			 [rskexchrate],			 [rsktaxamountmst],			 [rskfxhedgedtaxamount],			 [rskpriceqty],			 [rskpriceunit],			 [mnrgrossquantity],			 [dctvatdispatchid],			 [dctvatfromcountry],			 [dctvattocountry],			 [dctvatseqnum],			 [modifieddatetime],			 [modifiedby],			 [modifiedtransactionid],			 [createddatetime],			 [createdby],			 [createdtransactionid],			 [dataareaid],			 [recversion],			 [partition],			 [sysrowversion],			 [recid],			 [tableid],			 [versionnumber],			 [createdon],			 [modifiedon],			 [IsDelete],			 [PartitionId],			 [Ingestion_Timestamp],			 GETUTCDATE(),			 CONVERT(DATETIME, '31-12-9999', 103),			 CONVERT(BIT, 1),			 [ODSHashValue] 		FROM [21D365_stg].[vendinvoicetrans] WHERE [ODSRecordStatus] IN ('C', 'N');					   
				
/*
 ************************************************************************************************************
 *	End of creating the stored procedure.																	*
 ************************************************************************************************************
*/

END

GO

