
/*
 ************************************************************************************************************
 *	Create Stored Procedure.																				*
 ************************************************************************************************************
*/

CREATE PROCEDURE [21D365_ods].[usp_Insertsalestable]

AS

BEGIN

	/*
	 ********************************************************************************************************
	 *	Update the ODSHashValue Field in the Staging table with the Hash value of the record.				*
	 ********************************************************************************************************
	*/

	UPDATE A
	   SET [ODSHashValue] = CAST(HASHBYTES('MD5', ISNULL(SUBSTRING([Id], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([SinkCreatedOn] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL(CAST([SinkModifiedOn] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([autosummarymoduletype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([bankdocumenttype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([casetagging], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([constarget_jp], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([creditcardauthorizationerror], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([customsexportorder_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([customsshippingbill_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([deliverydatecontroltype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([documentstatus], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([einvoicelinespec], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([fiscaldoctype_pl], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([freightsliptype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([girotype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([incltax], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([intercompanyallowindirectcreation], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([intercompanyallowindirectcreationorig], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([intercompanyautocreateorders], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([intercompanydirectdelivery], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([intercompanydirectdeliveryorig], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([intercompanyorder], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([intercompanyorigin], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([invoiceautonumbering_lt], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([itemtagging], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([listcode], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([mcrorderstopped], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([natureofassessee_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([onetimecustomer], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([packingslipautonumbering_lt], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([pallettagging], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([pdsbatchattribautores], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([releasestatus], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([reservation], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([returnreplacementcreated], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([returnstatus], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([salesstatus], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([salestype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([settlevoucher], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([shipcarrierblindshipment], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([shipcarrierdlvtype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([shipcarrierexpeditedshipment], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([shipcarrierfuelsurcharge], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([shipcarrierresidential], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([skipupdate], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([systementrysource], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([touched], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([unitedvatinvoice_lt], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([skipcreatemarkup], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([skiplineupdate], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([invoiceregister_lt], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([packingslipregister_lt], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([foreigntrade_mx], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([sourcecertificate_mx], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([vatnumtabletype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([overridesalestax], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([mpsfullrunctpstatus], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([isintegration], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([mpsexcludesalesorder], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([mpsupdateexcludesalesorder], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([salesorderintegrationcreationtype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([commissiontype_it], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([printdynamicqrcode_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([invoicetype_w], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([cfditemporaryexport_mx], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([credmanexcludesalesorder], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([credmanreleasedfromcreditcontrol], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([credmanrejected], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([credmanincreditcontrol], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([domprocessed], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([domignore], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([domexceptiontype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([rskcxuseelementpricing], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([rskcxusepricecomponents], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecsordertype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecstradetype], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecsclosedfinance], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecsclosedlogistics], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecscontainsmultipleitems], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecscontractstatus], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecsisusingexternalitem], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecsprepaymentinvoicingmethod], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ccsclosingstatus], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([lgstransportcategory], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([lgsuselfoncontractlines], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([lgscreateintercompanylf], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([lgsweightcondition], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([mnrinvoicingweight], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([mnrpartialshipment], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([mnrtransshipment], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([mnrapproved], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([subbillcreatedfromsb], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([subbillsuppresschilditems], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([revrecfolloworiginalpricingmethod], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([revrecmultiplesoreallocation], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([gupskippricingcalculation], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([gupdelaypricingcalculation], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([sysdatastatecode], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([linedisc], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([salesid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([tdsgroup_in], 1, 255), '') + '|' + 							CAST(ISNULL([addressrefrecid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([addressreftableid], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([bankaccount_lv], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([bankcentralbankpurposecode], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([bankcentralbankpurposetext], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([cashdisc], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([cashdiscbasedate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([cashdiscbasedays], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([cashdiscpercent], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([commissiongroup], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([contactpersonid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([countyorigdest], 1, 255), '') + '|' + 							CAST(ISNULL([covstatus], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([creditcardapprovalamount], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([creditcardauthorization], 1, 255), '') + '|' + 							CAST(ISNULL([creditcardcustrefid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([creditnotereasoncode], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([curbankaccount_lv], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([currencycode], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([custaccount], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([custbankaccount_lv], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([custgroup], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([custinvoiceid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([customerref], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([deadline] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([defaultdimension], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([deliverydate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([deliveryname], 1, 255), '') + '|' + 							CAST(ISNULL([deliverypostaladdress], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([directdebitmandate], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([discpercent], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([dlvmode], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([dlvreason], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([dlvterm], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([einvoiceaccountcode], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([email], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([enddisc], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([enterprisenumber], 1, 255), '') + '|' + 							CAST(ISNULL([estimate], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([exportreason], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([fixedduedate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([fixedexchrate], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([freightzone], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([intercompanycompanyid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([intercompanyoriginalcustaccount], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([intercompanyoriginalsalesid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([intercompanypurchid], 1, 255), '') + '|' + 							CAST(ISNULL([intrastataddvalue_lv], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([intrastatfulfillmentdate_hu] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([inventlocationid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([inventsiteid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([invoiceaccount], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([languageid], 1, 255), '') + '|' + 							CAST(ISNULL([manualentrychangepolicy], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([markupgroup], 1, 255), '') + '|' + 							CAST(ISNULL([matchingagreement], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([multilinedisc], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([numbersequencegroup], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([payment], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([paymentsched], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([paymmode], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([paymspec], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([pdscustrebategroupid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([pdsrebateprogramtmagroup], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([port], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([postingprofile], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([pricegroupid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([projid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([purchid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([purchorderformnum], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([quotationid], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([receiptdateconfirmed] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL(CAST([receiptdaterequested] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([retailchanneltable], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([returndeadline] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([returnitemnum], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([returnreasoncodeid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([returnreplacementid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([salesgroup], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([salesname], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([salesoriginid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([salespoolid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([salesunitid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([shipcarrieraccount], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([shipcarrieraccountcode], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([shipcarrierdeliverycontact], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([shipcarrierid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([shipcarriername], 1, 255), '') + '|' + 							CAST(ISNULL([shipcarrierpostaladdress], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([shippingdateconfirmed] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL(CAST([shippingdaterequested] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([smmcampaignid], 1, 255), '') + '|' + 							CAST(ISNULL([smmsalesamounttotal], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([sourcedocumentheader], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([statprocid], 1, 255), '') + '|' + 							CAST(ISNULL([systementrychangepolicy], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([taxgroup], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([taxperiodpaymentcode_pl], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([tcsgroup_in], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([transactioncode], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([transport], 1, 255), '') + '|' + 							CAST(ISNULL([transportationdocument], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([url], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([vatnum], 1, 255), '') + '|' + 							CAST(ISNULL([workersalesresponsible], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([workersalestaker], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([einvoicecfdiconfirmnumber_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([satpaymmethod_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([satpurpose_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([certificatenumber_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([fiscaladdress_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([numregidtrib_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([satincotermcode_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([satshippingreason_mx], 1, 255), '') + '|' + 							CAST(ISNULL([accountingdistributiontemplate], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([fundingsource], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([reportingcurrencyfixedexchrate], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([asohorderclass], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([phone], 1, 255), '') + '|' + 							CAST(ISNULL([vatnumrecid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([fintag], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([intentletterid_it], 1, 255), '') + '|' + 							CAST(ISNULL([taxid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([eximports_in], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([electronicinvoiceframeworktype_fr], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([servicecode_fr], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([projectmanager_fr], 1, 255), '') + '|' + 							CAST(ISNULL([servicecoderefrecid], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([customsregime_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([credmanid], 1, 255), '') + '|' + 							CAST(ISNULL([domiterations], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([domprocesseddatetime] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([tamdeductionid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([tamrebatereference], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([dctdestination], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([dctshipfrom], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([dctshipto], 1, 255), '') + '|' + 							CAST(ISNULL([rsktrader], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([rsktradingbookid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([rskbankgroupid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([rskbankgroupsubaccountid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([rskcxelementpricingtemplateid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([rskcxpricecomponenttemplateid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([ecsconfigid], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([ecscontractdate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([ecscontractposition], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([ecsdatecontractactivated] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([ecsexternalitemid], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([ecsfinancialdateclosing] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([ecsfixedexchrate], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([ecsinventcolorid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([ecsinventdimid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([ecsinventsizeid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([ecsinventstyleid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([ecsitemid], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([ecslogisticdateclosing] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([ecsoverdeliverypct], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecspriceqty], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([ecspriceunit], 1, 255), '') + '|' + 							CAST(ISNULL([ecssalesprice], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecssalesqty], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([ecssalesunit], 1, 255), '') + '|' + 							CAST(ISNULL([ecstotalorderedqty], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecsunderdeliverypct], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecsworkercontractactivated], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecsworkerfinancialresponsible], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecsworkerlogisticresponsible], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecsworkersigner1], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecsworkersigner2], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecsmaincontract], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([ecsqtychecktolerancepct], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([ecsprocesscycleid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([ecsprocesscyclestatusid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([ccstemplateid], 1, 255), '') + '|' + 							CAST(ISNULL([ccsinsurancepercent], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([lgsdestinationid], 1, 255), '') + '|' + 							CAST(ISNULL([lgsqtypertransportunit], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([lgsshipmentperiod], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([lgsshipmentperiodfrom] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL(CAST([lgsshipmentperiodto] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([lgstransportunits], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([lgsdestination], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([lgsroutetemplateid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([lgsshipfrom], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([lgsshipto], 1, 255), '') + '|' + 							CAST(ISNULL([lgsworkerresponsible], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([mnrfinalcustomer], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([mnramountquantity], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([mnradditionalspecificationamtqty], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([mnramount], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([mnradditionalspecificationamt], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([mnrquantity], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([mnradditionalspecificationqty], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([mnrothertolerance], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([mnrcreditcontractreference], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([mnrlinerterm], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([mnrfinaldestination], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([mnrcountryregionid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([mnrcountryofsupply], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([mnritemremark], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([mnrannex], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([mnrgeneralcontractnumdate], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([dctvatfiscalunityid], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([subbillbilltoname], 1, 255), '') + '|' + 							CAST(ISNULL([subbillbilltopostaladdress], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([revreccontractenddate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL(CAST([revreccontractstartdate] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([revreclatestreversejournal], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([revrecreallocationid], 1, 255), '') + '|' + 							CAST(ISNULL(CAST([modifieddatetime] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([modifiedby], 1, 255), '') + '|' + 							CAST(ISNULL([modifiedtransactionid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([createddatetime] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							ISNULL(SUBSTRING([createdby], 1, 255), '') + '|' + 							CAST(ISNULL([createdtransactionid], 0) AS NVARCHAR(50)) + '|' + 							ISNULL(SUBSTRING([dataareaid], 1, 255), '') + '|' + 							CAST(ISNULL([recversion], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([partition], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([sysrowversion], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([recid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([tableid], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL([versionnumber], 0) AS NVARCHAR(50)) + '|' + 							CAST(ISNULL(CAST([createdon] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL(CAST([modifiedon] AS DATETIME2(6)), CAST('1901-01-01' AS DATETIME2(6))) AS NVARCHAR(26)) + '|' + 							CAST(ISNULL([IsDelete], 0) AS NVARCHAR(50)) + '|' + 							ISNULL([PartitionId], '') + '|' + 							ISNULL(SUBSTRING([mcfiscallegends_mx], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([mnrextrainfo], 1, 255), '') + '|' + 							ISNULL(SUBSTRING([mnrsalesidsource], 1, 255), '')) AS BINARY(16))
	  FROM [21D365_stg].[salestable] A; 

							 
	/*
	 ********************************************************************************************************
	 *	If the Destination table has no records update the Staging table Record Source with the value (N)ew.*
	 ********************************************************************************************************
	*/

	IF NOT EXISTS (SELECT count(*) FROM [21D365_ods].[salestable] HAVING count(*) > 0)
	BEGIN
	    UPDATE [21D365_stg].[salestable]
		   SET [ODSRecordStatus] = 'N'
		 WHERE [ODSRecordStatus] IS NULL
	END;

	/*
	 ********************************************************************************************************
	 *	If the Destination table is not empty Update the ODSRecordStatus with values (N), (C) or (S).		*
	 ********************************************************************************************************
	*/

	IF EXISTS (SELECT count(*) FROM [21D365_ods].[salestable] HAVING count(*) > 0)
	BEGIN

		UPDATE A
		   SET A.[ODSRecordStatus] = 'N'
		  FROM [21D365_stg].[salestable] A LEFT JOIN [21D365_ods].[salestable] B
		    ON A.[recid] = B.[recid]
		 WHERE B.[recid] IS NULL

		UPDATE A
		   SET A.[ODSRecordStatus] = 'C'
		  FROM [21D365_stg].[salestable] A INNER JOIN [21D365_ods].[salestable] B
		    ON A.[recid] = B.[recid]
		   AND A.[ODSHashValue] <> B.[ODSHashValue]

		UPDATE A
		   SET A.[ODSRecordStatus] = 'S'
		  FROM [21D365_stg].[salestable] A INNER JOIN [21D365_ods].[salestable] B
		    ON A.[recid] = B.[recid]
		   AND A.[ODSHashValue] = B.[ODSHashValue]
	END;				
	/*
	 ********************************************************************************************************
	 *	Update ODS Fields if table Exists.																	*
	 ********************************************************************************************************
	*/

	UPDATE A
	   SET A.[ODSEndDate] = GETDATE(),
		   A.[ODSActive] = CONVERT(BIT, 0)
	  FROM [21D365_ods].[salestable] A INNER JOIN [21D365_stg].[salestable] B
	    ON A.[recid] = B.[recid]
	 WHERE B.[ODSRecordStatus] = 'C'
	   AND A.[ODSEndDate] = CONVERT(DATETIME, '31-12-9999', 103)
	   AND A.[ODSActive] = CONVERT(BIT, 1); 
	
	/*
	 ********************************************************************************************************
	 *	Insert New And Changed records in the ODS Table.													*
	 ********************************************************************************************************
	*/

	INSERT INTO [21D365_ods].[salestable]			(			 [Id],			 [SinkCreatedOn],			 [SinkModifiedOn],			 [autosummarymoduletype],			 [bankdocumenttype],			 [casetagging],			 [constarget_jp],			 [creditcardauthorizationerror],			 [customsexportorder_in],			 [customsshippingbill_in],			 [deliverydatecontroltype],			 [documentstatus],			 [einvoicelinespec],			 [fiscaldoctype_pl],			 [freightsliptype],			 [girotype],			 [incltax],			 [intercompanyallowindirectcreation],			 [intercompanyallowindirectcreationorig],			 [intercompanyautocreateorders],			 [intercompanydirectdelivery],			 [intercompanydirectdeliveryorig],			 [intercompanyorder],			 [intercompanyorigin],			 [invoiceautonumbering_lt],			 [itemtagging],			 [listcode],			 [mcrorderstopped],			 [natureofassessee_in],			 [onetimecustomer],			 [packingslipautonumbering_lt],			 [pallettagging],			 [pdsbatchattribautores],			 [releasestatus],			 [reservation],			 [returnreplacementcreated],			 [returnstatus],			 [salesstatus],			 [salestype],			 [settlevoucher],			 [shipcarrierblindshipment],			 [shipcarrierdlvtype],			 [shipcarrierexpeditedshipment],			 [shipcarrierfuelsurcharge],			 [shipcarrierresidential],			 [skipupdate],			 [systementrysource],			 [touched],			 [unitedvatinvoice_lt],			 [skipcreatemarkup],			 [skiplineupdate],			 [invoiceregister_lt],			 [packingslipregister_lt],			 [foreigntrade_mx],			 [sourcecertificate_mx],			 [vatnumtabletype],			 [overridesalestax],			 [mpsfullrunctpstatus],			 [isintegration],			 [mpsexcludesalesorder],			 [mpsupdateexcludesalesorder],			 [salesorderintegrationcreationtype],			 [commissiontype_it],			 [printdynamicqrcode_in],			 [invoicetype_w],			 [cfditemporaryexport_mx],			 [credmanexcludesalesorder],			 [credmanreleasedfromcreditcontrol],			 [credmanrejected],			 [credmanincreditcontrol],			 [domprocessed],			 [domignore],			 [domexceptiontype],			 [rskcxuseelementpricing],			 [rskcxusepricecomponents],			 [ecsordertype],			 [ecstradetype],			 [ecsclosedfinance],			 [ecsclosedlogistics],			 [ecscontainsmultipleitems],			 [ecscontractstatus],			 [ecsisusingexternalitem],			 [ecsprepaymentinvoicingmethod],			 [ccsclosingstatus],			 [lgstransportcategory],			 [lgsuselfoncontractlines],			 [lgscreateintercompanylf],			 [lgsweightcondition],			 [mnrinvoicingweight],			 [mnrpartialshipment],			 [mnrtransshipment],			 [mnrapproved],			 [subbillcreatedfromsb],			 [subbillsuppresschilditems],			 [revrecfolloworiginalpricingmethod],			 [revrecmultiplesoreallocation],			 [gupskippricingcalculation],			 [gupdelaypricingcalculation],			 [sysdatastatecode],			 [linedisc],			 [salesid],			 [tdsgroup_in],			 [addressrefrecid],			 [addressreftableid],			 [bankaccount_lv],			 [bankcentralbankpurposecode],			 [bankcentralbankpurposetext],			 [cashdisc],			 [cashdiscbasedate],			 [cashdiscbasedays],			 [cashdiscpercent],			 [commissiongroup],			 [contactpersonid],			 [countyorigdest],			 [covstatus],			 [creditcardapprovalamount],			 [creditcardauthorization],			 [creditcardcustrefid],			 [creditnotereasoncode],			 [curbankaccount_lv],			 [currencycode],			 [custaccount],			 [custbankaccount_lv],			 [custgroup],			 [custinvoiceid],			 [customerref],			 [deadline],			 [defaultdimension],			 [deliverydate],			 [deliveryname],			 [deliverypostaladdress],			 [directdebitmandate],			 [discpercent],			 [dlvmode],			 [dlvreason],			 [dlvterm],			 [einvoiceaccountcode],			 [email],			 [enddisc],			 [enterprisenumber],			 [estimate],			 [exportreason],			 [fixedduedate],			 [fixedexchrate],			 [freightzone],			 [intercompanycompanyid],			 [intercompanyoriginalcustaccount],			 [intercompanyoriginalsalesid],			 [intercompanypurchid],			 [intrastataddvalue_lv],			 [intrastatfulfillmentdate_hu],			 [inventlocationid],			 [inventsiteid],			 [invoiceaccount],			 [languageid],			 [manualentrychangepolicy],			 [markupgroup],			 [matchingagreement],			 [multilinedisc],			 [numbersequencegroup],			 [payment],			 [paymentsched],			 [paymmode],			 [paymspec],			 [pdscustrebategroupid],			 [pdsrebateprogramtmagroup],			 [port],			 [postingprofile],			 [pricegroupid],			 [projid],			 [purchid],			 [purchorderformnum],			 [quotationid],			 [receiptdateconfirmed],			 [receiptdaterequested],			 [retailchanneltable],			 [returndeadline],			 [returnitemnum],			 [returnreasoncodeid],			 [returnreplacementid],			 [salesgroup],			 [salesname],			 [salesoriginid],			 [salespoolid],			 [salesunitid],			 [shipcarrieraccount],			 [shipcarrieraccountcode],			 [shipcarrierdeliverycontact],			 [shipcarrierid],			 [shipcarriername],			 [shipcarrierpostaladdress],			 [shippingdateconfirmed],			 [shippingdaterequested],			 [smmcampaignid],			 [smmsalesamounttotal],			 [sourcedocumentheader],			 [statprocid],			 [systementrychangepolicy],			 [taxgroup],			 [taxperiodpaymentcode_pl],			 [tcsgroup_in],			 [transactioncode],			 [transport],			 [transportationdocument],			 [url],			 [vatnum],			 [workersalesresponsible],			 [workersalestaker],			 [einvoicecfdiconfirmnumber_mx],			 [satpaymmethod_mx],			 [satpurpose_mx],			 [certificatenumber_mx],			 [fiscaladdress_mx],			 [numregidtrib_mx],			 [satincotermcode_mx],			 [satshippingreason_mx],			 [accountingdistributiontemplate],			 [fundingsource],			 [reportingcurrencyfixedexchrate],			 [asohorderclass],			 [phone],			 [vatnumrecid],			 [fintag],			 [intentletterid_it],			 [taxid],			 [eximports_in],			 [electronicinvoiceframeworktype_fr],			 [servicecode_fr],			 [projectmanager_fr],			 [servicecoderefrecid],			 [customsregime_mx],			 [credmanid],			 [domiterations],			 [domprocesseddatetime],			 [tamdeductionid],			 [tamrebatereference],			 [dctdestination],			 [dctshipfrom],			 [dctshipto],			 [rsktrader],			 [rsktradingbookid],			 [rskbankgroupid],			 [rskbankgroupsubaccountid],			 [rskcxelementpricingtemplateid],			 [rskcxpricecomponenttemplateid],			 [ecsconfigid],			 [ecscontractdate],			 [ecscontractposition],			 [ecsdatecontractactivated],			 [ecsexternalitemid],			 [ecsfinancialdateclosing],			 [ecsfixedexchrate],			 [ecsinventcolorid],			 [ecsinventdimid],			 [ecsinventsizeid],			 [ecsinventstyleid],			 [ecsitemid],			 [ecslogisticdateclosing],			 [ecsoverdeliverypct],			 [ecspriceqty],			 [ecspriceunit],			 [ecssalesprice],			 [ecssalesqty],			 [ecssalesunit],			 [ecstotalorderedqty],			 [ecsunderdeliverypct],			 [ecsworkercontractactivated],			 [ecsworkerfinancialresponsible],			 [ecsworkerlogisticresponsible],			 [ecsworkersigner1],			 [ecsworkersigner2],			 [ecsmaincontract],			 [ecsqtychecktolerancepct],			 [ecsprocesscycleid],			 [ecsprocesscyclestatusid],			 [ccstemplateid],			 [ccsinsurancepercent],			 [lgsdestinationid],			 [lgsqtypertransportunit],			 [lgsshipmentperiod],			 [lgsshipmentperiodfrom],			 [lgsshipmentperiodto],			 [lgstransportunits],			 [lgsdestination],			 [lgsroutetemplateid],			 [lgsshipfrom],			 [lgsshipto],			 [lgsworkerresponsible],			 [mnrfinalcustomer],			 [mnramountquantity],			 [mnradditionalspecificationamtqty],			 [mnramount],			 [mnradditionalspecificationamt],			 [mnrquantity],			 [mnradditionalspecificationqty],			 [mnrothertolerance],			 [mnrcreditcontractreference],			 [mnrlinerterm],			 [mnrfinaldestination],			 [mnrcountryregionid],			 [mnrcountryofsupply],			 [mnritemremark],			 [mnrannex],			 [mnrgeneralcontractnumdate],			 [dctvatfiscalunityid],			 [subbillbilltoname],			 [subbillbilltopostaladdress],			 [revreccontractenddate],			 [revreccontractstartdate],			 [revreclatestreversejournal],			 [revrecreallocationid],			 [modifieddatetime],			 [modifiedby],			 [modifiedtransactionid],			 [createddatetime],			 [createdby],			 [createdtransactionid],			 [dataareaid],			 [recversion],			 [partition],			 [sysrowversion],			 [recid],			 [tableid],			 [versionnumber],			 [createdon],			 [modifiedon],			 [IsDelete],			 [PartitionId],			 [mcfiscallegends_mx],			 [mnrextrainfo],			 [mnrsalesidsource],			 [ODSStartDate],			 [ODSEndDate],			 [ODSActive],			 [ODSHashValue]			) 	  SELECT [Id],			 [SinkCreatedOn],			 [SinkModifiedOn],			 [autosummarymoduletype],			 [bankdocumenttype],			 [casetagging],			 [constarget_jp],			 [creditcardauthorizationerror],			 [customsexportorder_in],			 [customsshippingbill_in],			 [deliverydatecontroltype],			 [documentstatus],			 [einvoicelinespec],			 [fiscaldoctype_pl],			 [freightsliptype],			 [girotype],			 [incltax],			 [intercompanyallowindirectcreation],			 [intercompanyallowindirectcreationorig],			 [intercompanyautocreateorders],			 [intercompanydirectdelivery],			 [intercompanydirectdeliveryorig],			 [intercompanyorder],			 [intercompanyorigin],			 [invoiceautonumbering_lt],			 [itemtagging],			 [listcode],			 [mcrorderstopped],			 [natureofassessee_in],			 [onetimecustomer],			 [packingslipautonumbering_lt],			 [pallettagging],			 [pdsbatchattribautores],			 [releasestatus],			 [reservation],			 [returnreplacementcreated],			 [returnstatus],			 [salesstatus],			 [salestype],			 [settlevoucher],			 [shipcarrierblindshipment],			 [shipcarrierdlvtype],			 [shipcarrierexpeditedshipment],			 [shipcarrierfuelsurcharge],			 [shipcarrierresidential],			 [skipupdate],			 [systementrysource],			 [touched],			 [unitedvatinvoice_lt],			 [skipcreatemarkup],			 [skiplineupdate],			 [invoiceregister_lt],			 [packingslipregister_lt],			 [foreigntrade_mx],			 [sourcecertificate_mx],			 [vatnumtabletype],			 [overridesalestax],			 [mpsfullrunctpstatus],			 [isintegration],			 [mpsexcludesalesorder],			 [mpsupdateexcludesalesorder],			 [salesorderintegrationcreationtype],			 [commissiontype_it],			 [printdynamicqrcode_in],			 [invoicetype_w],			 [cfditemporaryexport_mx],			 [credmanexcludesalesorder],			 [credmanreleasedfromcreditcontrol],			 [credmanrejected],			 [credmanincreditcontrol],			 [domprocessed],			 [domignore],			 [domexceptiontype],			 [rskcxuseelementpricing],			 [rskcxusepricecomponents],			 [ecsordertype],			 [ecstradetype],			 [ecsclosedfinance],			 [ecsclosedlogistics],			 [ecscontainsmultipleitems],			 [ecscontractstatus],			 [ecsisusingexternalitem],			 [ecsprepaymentinvoicingmethod],			 [ccsclosingstatus],			 [lgstransportcategory],			 [lgsuselfoncontractlines],			 [lgscreateintercompanylf],			 [lgsweightcondition],			 [mnrinvoicingweight],			 [mnrpartialshipment],			 [mnrtransshipment],			 [mnrapproved],			 [subbillcreatedfromsb],			 [subbillsuppresschilditems],			 [revrecfolloworiginalpricingmethod],			 [revrecmultiplesoreallocation],			 [gupskippricingcalculation],			 [gupdelaypricingcalculation],			 [sysdatastatecode],			 [linedisc],			 [salesid],			 [tdsgroup_in],			 [addressrefrecid],			 [addressreftableid],			 [bankaccount_lv],			 [bankcentralbankpurposecode],			 [bankcentralbankpurposetext],			 [cashdisc],			 [cashdiscbasedate],			 [cashdiscbasedays],			 [cashdiscpercent],			 [commissiongroup],			 [contactpersonid],			 [countyorigdest],			 [covstatus],			 [creditcardapprovalamount],			 [creditcardauthorization],			 [creditcardcustrefid],			 [creditnotereasoncode],			 [curbankaccount_lv],			 [currencycode],			 [custaccount],			 [custbankaccount_lv],			 [custgroup],			 [custinvoiceid],			 [customerref],			 [deadline],			 [defaultdimension],			 [deliverydate],			 [deliveryname],			 [deliverypostaladdress],			 [directdebitmandate],			 [discpercent],			 [dlvmode],			 [dlvreason],			 [dlvterm],			 [einvoiceaccountcode],			 [email],			 [enddisc],			 [enterprisenumber],			 [estimate],			 [exportreason],			 [fixedduedate],			 [fixedexchrate],			 [freightzone],			 [intercompanycompanyid],			 [intercompanyoriginalcustaccount],			 [intercompanyoriginalsalesid],			 [intercompanypurchid],			 [intrastataddvalue_lv],			 [intrastatfulfillmentdate_hu],			 [inventlocationid],			 [inventsiteid],			 [invoiceaccount],			 [languageid],			 [manualentrychangepolicy],			 [markupgroup],			 [matchingagreement],			 [multilinedisc],			 [numbersequencegroup],			 [payment],			 [paymentsched],			 [paymmode],			 [paymspec],			 [pdscustrebategroupid],			 [pdsrebateprogramtmagroup],			 [port],			 [postingprofile],			 [pricegroupid],			 [projid],			 [purchid],			 [purchorderformnum],			 [quotationid],			 [receiptdateconfirmed],			 [receiptdaterequested],			 [retailchanneltable],			 [returndeadline],			 [returnitemnum],			 [returnreasoncodeid],			 [returnreplacementid],			 [salesgroup],			 [salesname],			 [salesoriginid],			 [salespoolid],			 [salesunitid],			 [shipcarrieraccount],			 [shipcarrieraccountcode],			 [shipcarrierdeliverycontact],			 [shipcarrierid],			 [shipcarriername],			 [shipcarrierpostaladdress],			 [shippingdateconfirmed],			 [shippingdaterequested],			 [smmcampaignid],			 [smmsalesamounttotal],			 [sourcedocumentheader],			 [statprocid],			 [systementrychangepolicy],			 [taxgroup],			 [taxperiodpaymentcode_pl],			 [tcsgroup_in],			 [transactioncode],			 [transport],			 [transportationdocument],			 [url],			 [vatnum],			 [workersalesresponsible],			 [workersalestaker],			 [einvoicecfdiconfirmnumber_mx],			 [satpaymmethod_mx],			 [satpurpose_mx],			 [certificatenumber_mx],			 [fiscaladdress_mx],			 [numregidtrib_mx],			 [satincotermcode_mx],			 [satshippingreason_mx],			 [accountingdistributiontemplate],			 [fundingsource],			 [reportingcurrencyfixedexchrate],			 [asohorderclass],			 [phone],			 [vatnumrecid],			 [fintag],			 [intentletterid_it],			 [taxid],			 [eximports_in],			 [electronicinvoiceframeworktype_fr],			 [servicecode_fr],			 [projectmanager_fr],			 [servicecoderefrecid],			 [customsregime_mx],			 [credmanid],			 [domiterations],			 [domprocesseddatetime],			 [tamdeductionid],			 [tamrebatereference],			 [dctdestination],			 [dctshipfrom],			 [dctshipto],			 [rsktrader],			 [rsktradingbookid],			 [rskbankgroupid],			 [rskbankgroupsubaccountid],			 [rskcxelementpricingtemplateid],			 [rskcxpricecomponenttemplateid],			 [ecsconfigid],			 [ecscontractdate],			 [ecscontractposition],			 [ecsdatecontractactivated],			 [ecsexternalitemid],			 [ecsfinancialdateclosing],			 [ecsfixedexchrate],			 [ecsinventcolorid],			 [ecsinventdimid],			 [ecsinventsizeid],			 [ecsinventstyleid],			 [ecsitemid],			 [ecslogisticdateclosing],			 [ecsoverdeliverypct],			 [ecspriceqty],			 [ecspriceunit],			 [ecssalesprice],			 [ecssalesqty],			 [ecssalesunit],			 [ecstotalorderedqty],			 [ecsunderdeliverypct],			 [ecsworkercontractactivated],			 [ecsworkerfinancialresponsible],			 [ecsworkerlogisticresponsible],			 [ecsworkersigner1],			 [ecsworkersigner2],			 [ecsmaincontract],			 [ecsqtychecktolerancepct],			 [ecsprocesscycleid],			 [ecsprocesscyclestatusid],			 [ccstemplateid],			 [ccsinsurancepercent],			 [lgsdestinationid],			 [lgsqtypertransportunit],			 [lgsshipmentperiod],			 [lgsshipmentperiodfrom],			 [lgsshipmentperiodto],			 [lgstransportunits],			 [lgsdestination],			 [lgsroutetemplateid],			 [lgsshipfrom],			 [lgsshipto],			 [lgsworkerresponsible],			 [mnrfinalcustomer],			 [mnramountquantity],			 [mnradditionalspecificationamtqty],			 [mnramount],			 [mnradditionalspecificationamt],			 [mnrquantity],			 [mnradditionalspecificationqty],			 [mnrothertolerance],			 [mnrcreditcontractreference],			 [mnrlinerterm],			 [mnrfinaldestination],			 [mnrcountryregionid],			 [mnrcountryofsupply],			 [mnritemremark],			 [mnrannex],			 [mnrgeneralcontractnumdate],			 [dctvatfiscalunityid],			 [subbillbilltoname],			 [subbillbilltopostaladdress],			 [revreccontractenddate],			 [revreccontractstartdate],			 [revreclatestreversejournal],			 [revrecreallocationid],			 [modifieddatetime],			 [modifiedby],			 [modifiedtransactionid],			 [createddatetime],			 [createdby],			 [createdtransactionid],			 [dataareaid],			 [recversion],			 [partition],			 [sysrowversion],			 [recid],			 [tableid],			 [versionnumber],			 [createdon],			 [modifiedon],			 [IsDelete],			 [PartitionId],			 [mcfiscallegends_mx],			 [mnrextrainfo],			 [mnrsalesidsource],			 GETUTCDATE(),			 CONVERT(DATETIME, '31-12-9999', 103),			 CONVERT(BIT, 1),			 [ODSHashValue] 		FROM [21D365_stg].[salestable] WHERE [ODSRecordStatus] IN ('C', 'N');					   
				
/*
 ************************************************************************************************************
 *	End of creating the stored procedure.																	*
 ************************************************************************************************************
*/

END

GO

