WITH source_date AS (
    SELECT
	    -- Keys
	    CAST(dat.date_key AS INT) AS tkey_date,
	    CAST(dat.date_key AS INT) AS bkey_date,	
	    -- Attributes	
	    CAST(dat.[date] AS DATETIME2(0)) AS [date],
        CAST(dat.[year] AS VARCHAR(255)) AS [year],
	    dat.previous_year,
	    dat.number_of_days_in_year,
	    dat.number_of_work_days_in_year,
	    dat.semester,
	    dat.previous_semester,
	    dat.semester_description_short,
	    dat.semester_description_long,
	    dat.previous_semester_description_short,
	    dat.previous_semester_description_long,
	    dat.number_of_days_in_semester,
	    dat.number_of_work_days_in_semester,
	    dat.[quarter],
	    dat.previous_quarter,
	    dat.quarter_description_short,
	    dat.quarter_description_long,
	    dat.previous_quarter_description_short,
	    dat.previous_quarter_description_long,
	    dat.number_of_days_in_quarter,
	    dat.number_of_work_days_in_quarter,
	    dat.month_key,
	    dat.[month],
	    dat.previous_month,
	    dat.month_description_short,
	    dat.month_description_long,
	    dat.previous_month_description_short,
	    dat.previous_month_description_long,
	    dat.number_of_days_in_month,
	    dat.number_of_work_days_in_month,
	    dat.[week],
	    dat.previous_week,
	    dat.week_description_short,
	    dat.week_description_long,
	    dat.previous_week_description_short,
	    dat.previous_week_description_long,
	    dat.[day],
	    dat.day_description_short,
	    dat.day_description_long,
	    dat.day_in_year,
	    dat.day_in_semester,
	    dat.day_in_quarter,
	    dat.day_in_week,
	    dat.working_day_in_year,
	    dat.working_day_in_semester,
	    dat.working_day_in_quarter,
	    dat.working_day_in_month,
	    dat.day_name_short,
	    dat.day_name_long
    FROM {{ ref('bv_date') }} AS dat
)

SELECT 
    tkey_date,
	bkey_date,	
	[date],
    [year],
	previous_year,
	number_of_days_in_year,
	number_of_work_days_in_year,
	semester,
	previous_semester,
	semester_description_short,
	semester_description_long,
	previous_semester_description_short,
	previous_semester_description_long,
	number_of_days_in_semester,
	number_of_work_days_in_semester,
	[quarter],
	previous_quarter,
	quarter_description_short,
	quarter_description_long,
	previous_quarter_description_short,
	previous_quarter_description_long,
	number_of_days_in_quarter,
	number_of_work_days_in_quarter,
	month_key,
	[month],
	previous_month,
	month_description_short,
	month_description_long,
	previous_month_description_short,
	previous_month_description_long,
	number_of_days_in_month,
	number_of_work_days_in_month,
	[week],
	previous_week,
	week_description_short,
	week_description_long,
	previous_week_description_short,
	previous_week_description_long,
	[day],
	day_description_short,
	day_description_long,
	day_in_year,
	day_in_semester,
	day_in_quarter,
	day_in_week,
	working_day_in_year,
	working_day_in_semester,
	working_day_in_quarter,
	working_day_in_month,
	day_name_short,
	day_name_long
FROM source_date