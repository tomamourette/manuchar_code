WITH dbb_lakehouse_date AS (
    SELECT 
        ldat.date_key,
        CONVERT(VARCHAR, ldat.date) + '_DBB_LAKEHOUSE' AS bkey_date_source,
        CONVERT(DATE, ldat.date) AS bkey_date,
        'DBB_LAKEHOUSE' AS bkey_source,
        ldat.date,
        ldat.year,
        ldat.previous_year,
        ldat.number_of_days_in_year,
        ldat.number_of_work_days_in_year,
        ldat.semester,
        ldat.previous_semester,
        ldat.semester_description_short,
        ldat.semester_description_long,
        ldat.previous_semester_description_short,
        ldat.previous_semester_description_long,
        ldat.number_of_days_in_semester,
        ldat.number_of_work_days_in_semester,
        ldat.quarter,
        ldat.previous_quarter,
        ldat.quarter_description_short,
        ldat.quarter_description_long,
        ldat.previous_quarter_description_short,
        ldat.previous_quarter_description_long,
        ldat.number_of_days_in_quarter,
        ldat.number_of_work_days_in_quarter,
        ldat.month_key,
        ldat.month,
        ldat.previous_month,
        ldat.month_description_short,
        ldat.month_description_long,
        ldat.previous_month_description_short,
        ldat.previous_month_description_long,
        ldat.number_of_days_in_month,
        ldat.number_of_work_days_in_month,
        ldat.week,
        ldat.previous_week,
        ldat.week_description_short,
        ldat.week_description_long,
        ldat.previous_week_description_short,
        ldat.previous_week_description_long,
        ldat.day,
        ldat.day_description_short,
        ldat.day_description_long,
        ldat.day_in_year,
        ldat.day_in_semester,
        ldat.day_in_quarter,
        ldat.day_in_week,
        ldat.working_day_in_year,
        ldat.working_day_in_semester,
        ldat.working_day_in_quarter,
        ldat.working_day_in_month,
        ldat.day_name_short,
        ldat.day_name_long
    FROM {{ ref('sv_oil_genericdata_dates')}} AS ldat
)

SELECT
    date_key,
    bkey_date_source,
    bkey_date,
    bkey_source,
    [date],
    [year],
    previous_year,
    number_of_days_in_year,
    number_of_work_days_in_year,
    semester,
    previous_semester,
    semester_description_short,
    semester_description_long,
    previous_semester_description_short,
    previous_semester_description_long,
    number_of_days_in_semester,
    number_of_work_days_in_semester,
    [quarter],
    previous_quarter,
    quarter_description_short,
    quarter_description_long,
    previous_quarter_description_short,
    previous_quarter_description_long,
    number_of_days_in_quarter,
    number_of_work_days_in_quarter,
    month_key,
    [month],
    previous_month,
    month_description_short,
    month_description_long,
    previous_month_description_short,
    previous_month_description_long,
    number_of_days_in_month,
    number_of_work_days_in_month,
    [week],
    previous_week,
    week_description_short,
    week_description_long,
    previous_week_description_short,
    previous_week_description_long,
    [day],
    day_description_short,
    day_description_long,
    day_in_year,
    day_in_semester,
    day_in_quarter,
    day_in_week,
    working_day_in_year,
    working_day_in_semester,
    working_day_in_quarter,
    working_day_in_month,
    day_name_short,
    day_name_long
FROM dbb_lakehouse_date