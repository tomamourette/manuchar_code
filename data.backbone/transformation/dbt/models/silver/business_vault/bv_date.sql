WITH source_date AS (
    SELECT
        hub.bkey_date,
        hub.bkey_source,
        sat.date_key,
        sat.date,
        sat.year,
        sat.previous_year,
        sat.number_of_days_in_year,
        sat.number_of_work_days_in_year,
        sat.semester,
        sat.previous_semester,
        sat.semester_description_short,
        sat.semester_description_long,
        sat.previous_semester_description_short,
        sat.previous_semester_description_long,
        sat.number_of_days_in_semester,
        sat.number_of_work_days_in_semester,
        sat.quarter,
        sat.previous_quarter,
        sat.quarter_description_short,
        sat.quarter_description_long,
        sat.previous_quarter_description_short,
        sat.previous_quarter_description_long,
        sat.number_of_days_in_quarter,
        sat.number_of_work_days_in_quarter,
        sat.month_key,
        sat.month,
        sat.previous_month,
        sat.month_description_short,
        sat.month_description_long,
        sat.previous_month_description_short,
        sat.previous_month_description_long,
        sat.number_of_days_in_month,
        sat.number_of_work_days_in_month,
        sat.week,
        sat.previous_week,
        sat.week_description_short,
        sat.week_description_long,
        sat.previous_week_description_short,
        sat.previous_week_description_long,
        sat.day,
        sat.day_description_short,
        sat.day_description_long,
        sat.day_in_year,
        sat.day_in_semester,
        sat.day_in_quarter,
        sat.day_in_week,
        sat.working_day_in_year,
        sat.working_day_in_semester,
        sat.working_day_in_quarter,
        sat.working_day_in_month,
        sat.day_name_short,
        sat.day_name_long
    FROM {{ ref('rv_hub_date') }} AS hub 
    INNER JOIN {{ ref('rv_sat_date') }} AS sat ON hub.bkey_date_source = sat.bkey_date_source
)

SELECT
    bkey_date,
    date_key,
    [date],
    [year],
    previous_year,
    number_of_days_in_year,
    number_of_work_days_in_year,
    semester,
    previous_semester,
    semester_description_short,
    semester_description_long,
    previous_semester_description_short,
    previous_semester_description_long,
    number_of_days_in_semester,
    number_of_work_days_in_semester,
    [quarter],
    previous_quarter,
    quarter_description_short,
    quarter_description_long,
    previous_quarter_description_short,
    previous_quarter_description_long,
    number_of_days_in_quarter,
    number_of_work_days_in_quarter,
    month_key,
    [month],
    previous_month,
    month_description_short,
    month_description_long,
    previous_month_description_short,
    previous_month_description_long,
    number_of_days_in_month,
    number_of_work_days_in_month,
    [week],
    previous_week,
    week_description_short,
    week_description_long,
    previous_week_description_short,
    previous_week_description_long,
    [day],
    day_description_short,
    day_description_long,
    day_in_year,
    day_in_semester,
    day_in_quarter,
    day_in_week,
    working_day_in_year,
    working_day_in_semester,
    working_day_in_quarter,
    working_day_in_month,
    day_name_short,
    day_name_long
FROM source_date