WITH purchase_invoice_line_cogs AS (
    SELECT
	     mits.tkey_purchase_invoice_line_cogs,
         mits.bkey_purchase_invoice_line_cogs_source,
         mits.bkey_source,
         mits.bkey_flow,
         mits.purchase_invoice_line_cogs_file_number,
         mits.purchase_invoice_line_cogs_payment_schedule,
         mits.purchase_invoice_line_cogs_payment,
         mits.purchase_invoice_line_cogs_dct_destination,
         mits.purchase_invoice_line_cogs_ecs_contract_status,
         mits.purchase_invoice_line_cogs_risk_trading_book_id,
         mits.purchase_invoice_line_cogs_created_date_time,
         mits.purchase_invoice_line_cogs_company,
         mits.purchase_invoice_line_cogs_order_account,
         mits.purchase_invoice_line_cogs_requester,
         mits.purchase_invoice_line_cogs_risk_trader,
         mits.purchase_invoice_line_cogs_worker_purchase_placer,
         mits.purchase_invoice_line_cogs_purchase_state,
         mits.purchase_invoice_line_cogs_ccs_closing_status,
         mits.purchase_invoice_line_cogs_ecs_trade_type,
         mits.purchase_invoice_line_cogs_purchase_type,
         mits.purchase_invoice_line_cogs_invoice_account,
         mits.purchase_invoice_line_cogs_accounting_date,
         mits.purchase_invoice_line_cogs_internal_invoice_id,
         mits.purchase_invoice_line_cogs_product,
         mits.purchase_invoice_line_cogs_purchase_id,
         mits.purchase_invoice_line_cogs_line_number,
         mits.purchase_invoice_line_cogs_incoterm,
         mits.purchase_invoice_line_cogs_origin_country,
         mits.purchase_invoice_line_cogs_destination_country,
         mits.purchase_invoice_line_cogs_adjusted_cogs_functional,
         mits.purchase_invoice_line_cogs_adjusted_cogs_transactional,
         mits.purchase_invoice_line_cogs_adjusted_cogs_group_conso_avg,
         mits.purchase_invoice_line_cogs_cogs1_purchase_amount_functional,
         mits.purchase_invoice_line_cogs_cogs1_purchase_amount_transactional,
         mits.purchase_invoice_line_cogs_cogs1_purchase_amount_group_conso_avg,
         mits.purchase_invoice_line_cogs_cogs1_freight_amount_functional,
         mits.purchase_invoice_line_cogs_cogs1_freight_amount_transactional,
         mits.purchase_invoice_line_cogs_cogs1_freight_amount_group_conso_avg,
         mits.purchase_invoice_line_cogs_cogs1_other_amount_functional,
         mits.purchase_invoice_line_cogs_cogs1_other_amount_transactional,
         mits.purchase_invoice_line_cogs_cogs1_other_amount_group_conso_avg,
         mits.valid_from,
         mits.valid_to,
         mits.is_current
    FROM {{ ref('purchase_invoice_line_cogs_dynamics_mits')}} mits
    WHERE bkey_purchase_invoice_line_cogs IS NOT NULL
    UNION ALL
    SELECT
	    mst.tkey_purchase_invoice_line_cogs,
        mst.bkey_purchase_invoice_line_cogs_source,
        mst.bkey_source,
        mst.bkey_flow,
        mst.purchase_invoice_line_cogs_file_number,
        mst.purchase_invoice_line_cogs_payment_schedule,
        mst.purchase_invoice_line_cogs_payment,
        mst.purchase_invoice_line_cogs_dct_destination,
        mst.purchase_invoice_line_cogs_ecs_contract_status,
        mst.purchase_invoice_line_cogs_risk_trading_book_id,
        mst.purchase_invoice_line_cogs_created_date_time,
        mst.purchase_invoice_line_cogs_company,
        mst.purchase_invoice_line_cogs_order_account,
        mst.purchase_invoice_line_cogs_requester,
        mst.purchase_invoice_line_cogs_risk_trader,
        mst.purchase_invoice_line_cogs_worker_purchase_placer,
        mst.purchase_invoice_line_cogs_purchase_state,
        mst.purchase_invoice_line_cogs_ccs_closing_status,
        mst.purchase_invoice_line_cogs_ecs_trade_type,
        mst.purchase_invoice_line_cogs_purchase_type,
        mst.purchase_invoice_line_cogs_invoice_account,
        mst.purchase_invoice_line_cogs_accounting_date,
        mst.purchase_invoice_line_cogs_internal_invoice_id,
        mst.purchase_invoice_line_cogs_product,
        mst.purchase_invoice_line_cogs_purchase_id,
        mst.purchase_invoice_line_cogs_line_number,
        mst.purchase_invoice_line_cogs_incoterm,
        mst.purchase_invoice_line_cogs_origin_country,
        mst.purchase_invoice_line_cogs_destination_country,
        mst.purchase_invoice_line_cogs_adjusted_cogs_functional,
        mst.purchase_invoice_line_cogs_adjusted_cogs_transactional,
        mst.purchase_invoice_line_cogs_adjusted_cogs_group_conso_avg,
        mst.purchase_invoice_line_cogs_cogs1_purchase_amount_functional,
        mst.purchase_invoice_line_cogs_cogs1_purchase_amount_transactional,
        mst.purchase_invoice_line_cogs_cogs1_purchase_amount_group_conso_avg,
        mst.purchase_invoice_line_cogs_cogs1_freight_amount_functional,
        mst.purchase_invoice_line_cogs_cogs1_freight_amount_transactional,
        mst.purchase_invoice_line_cogs_cogs1_freight_amount_group_conso_avg,
        mst.purchase_invoice_line_cogs_cogs1_other_amount_functional,
        mst.purchase_invoice_line_cogs_cogs1_other_amount_transactional,
        mst.purchase_invoice_line_cogs_cogs1_other_amount_group_conso_avg,
        mst.valid_from,
        mst.valid_to,
        mst.is_current
    FROM {{ ref('purchase_invoice_line_cogs_dynamics_mst')}} mst
    UNION ALL
    SELECT
	    mtm.tkey_purchase_invoice_line_cogs,
        mtm.bkey_purchase_invoice_line_cogs_source,
        mtm.bkey_source,
        mtm.bkey_flow,
        mtm.purchase_invoice_line_cogs_file_number,
        mtm.purchase_invoice_line_cogs_payment_schedule,
        mtm.purchase_invoice_line_cogs_payment,
        mtm.purchase_invoice_line_cogs_dct_destination,
        mtm.purchase_invoice_line_cogs_ecs_contract_status,
        mtm.purchase_invoice_line_cogs_risk_trading_book_id,
        mtm.purchase_invoice_line_cogs_created_date_time,
        mtm.purchase_invoice_line_cogs_company,
        mtm.purchase_invoice_line_cogs_order_account,
        mtm.purchase_invoice_line_cogs_requester,
        mtm.purchase_invoice_line_cogs_risk_trader,
        mtm.purchase_invoice_line_cogs_worker_purchase_placer,
        mtm.purchase_invoice_line_cogs_purchase_state,
        mtm.purchase_invoice_line_cogs_ccs_closing_status,
        mtm.purchase_invoice_line_cogs_ecs_trade_type,
        mtm.purchase_invoice_line_cogs_purchase_type,
        mtm.purchase_invoice_line_cogs_invoice_account,
        mtm.purchase_invoice_line_cogs_accounting_date,
        mtm.purchase_invoice_line_cogs_internal_invoice_id,
        mtm.purchase_invoice_line_cogs_product,
        mtm.purchase_invoice_line_cogs_purchase_id,
        mtm.purchase_invoice_line_cogs_line_number,
        mtm.purchase_invoice_line_cogs_incoterm,
        mtm.purchase_invoice_line_cogs_origin_country,
        mtm.purchase_invoice_line_cogs_destination_country,
        mtm.purchase_invoice_line_cogs_adjusted_cogs_functional,
        mtm.purchase_invoice_line_cogs_adjusted_cogs_transactional,
        mtm.purchase_invoice_line_cogs_adjusted_cogs_group_conso_avg,
        mtm.purchase_invoice_line_cogs_cogs1_purchase_amount_functional,
        mtm.purchase_invoice_line_cogs_cogs1_purchase_amount_transactional,
        mtm.purchase_invoice_line_cogs_cogs1_purchase_amount_group_conso_avg,
        mtm.purchase_invoice_line_cogs_cogs1_freight_amount_functional,
        mtm.purchase_invoice_line_cogs_cogs1_freight_amount_transactional,
        mtm.purchase_invoice_line_cogs_cogs1_freight_amount_group_conso_avg,
        mtm.purchase_invoice_line_cogs_cogs1_other_amount_functional,
        mtm.purchase_invoice_line_cogs_cogs1_other_amount_transactional,
        mtm.purchase_invoice_line_cogs_cogs1_other_amount_group_conso_avg,
        mtm.valid_from,
        mtm.valid_to,
        mtm.is_current
    FROM {{ ref('purchase_invoice_line_cogs_mtm')}} mtm
)

SELECT
    *
FROM purchase_invoice_line_cogs